# âœ¨ AI ìë™ ì½”ë“œ ë¦¬ë·° ë¦¬í¬íŠ¸ (Engine: GEMINI)

**ë‚ ì§œ**: 2026-01-24 16-08-15
**ì»¤ë°‹**: `3d15b9019`
**ë¸Œëœì¹˜**: `main`
**AI ì—”ì§„**: **GEMINI**

---

## ğŸ” ì‹¤ì‹œê°„ ê²€ì¦ ê²°ê³¼ (2026-01-24 16:08:15)

```
ESLint: ìë™ ê²€ì¦ (pre-push)
TypeScript: ìë™ ê²€ì¦ (pre-push)
```

**ê²€ì¦ ë¡œê·¸ íŒŒì¼**:
- ESLint: `logs/validation/`
- TypeScript: `logs/validation/`

---

## ğŸ“Š ë³€ê²½ì‚¬í•­ ìš”ì•½

**ì»¤ë°‹**: `3d15b9019b493ece418bbdd2c81e229e0f517aa5`
**ë©”ì‹œì§€**: refactor(ai-engine): AI SDK v6 best practices and dead code cleanup

## ğŸ“„ cloud-run/ai-engine/src/services/ai-sdk/agents/orchestrator.ts

```diff
diff --git a/cloud-run/ai-engine/src/services/ai-sdk/agents/orchestrator.ts b/cloud-run/ai-engine/src/services/ai-sdk/agents/orchestrator.ts
index 81b5b9295..ba423c934 100644
--- a/cloud-run/ai-engine/src/services/ai-sdk/agents/orchestrator.ts
+++ b/cloud-run/ai-engine/src/services/ai-sdk/agents/orchestrator.ts
@@ -11,7 +11,7 @@
  * @updated 2026-01-24 - Removed @ai-sdk-tools/agents dependency
  */
 
-import { generateText, generateObject, streamText, stepCountIs, type ModelMessage } from 'ai';
+import { generateText, generateObject, streamText, stepCountIs, hasToolCall, type ModelMessage } from 'ai';
 import { getCerebrasModel, getGroqModel, getMistralModel, checkProviderStatus, type ProviderName } from '../model-provider';
 import { generateTextWithRetry } from '../../resilience/retry-with-fallback';
 import { sanitizeChineseCharacters } from '../../../lib/text-sanitizer';
@@ -24,6 +24,9 @@ import { AGENT_CONFIGS, type AgentConfig } from './config';
 // Import Zod schemas for type-safe structured output
 import { routingSchema, taskDecomposeSchema, getAgentFromRouting, type RoutingDecision, type TaskDecomposition, type Subtask } from './schemas';
 
+// Import Reporter Pipeline for Evaluator-Optimizer pattern
+import { executeReporterPipeline, type PipelineResult } from './reporter-pipeline';
+
 // ============================================================================
 // Configuration
 // ============================================================================
@@ -81,6 +84,8 @@ export interface MultiAgentResponse {
     modelId: string;
     totalRounds: number;
     durationMs: number;
+    /** Quality score from Reporter Pipeline (optional, 0-1) */
+    qualityScore?: number;
   };
 }
 
@@ -514,6 +519,112 @@ export function getRecentHandoffs() {
   return handoffEvents.slice(-10);
 }
 
+// ============================================================================
+// Reporter Pipeline Execution (Evaluator-Optimizer Pattern)
+// ============================================================================
+
+/**
+ * Execute Reporter Agent through the Pipeline for quality-controlled reports
+ *
+ * Uses Evaluator-Optimizer pattern:
+ * 1. Generate initial report
+ * 2. Evaluate quality (threshold: 0.75)
+ * 3. Optimize if needed (max 2 iterations)
+ *
+ * @param query - User query for report generation
+ * @param startTime - Execution start time for duration tracking
+ * @returns MultiAgentResponse with quality metrics, or null on failure
+ */
+async function executeReporterWithPipeline(
+  query: string,
+  startTime: number
+): Promise<MultiAgentResponse | null> {
+  console.log(`ğŸ“‹ [ReporterPipeline] Starting pipeline for query: "${query.substring(0, 50)}..."`);
+
+  try {
+    const pipelineResult = await executeReporterPipeline(query, {
+      qualityThreshold: 0.75,
+      maxIterations: 2,
+      timeout: 45_000,
+    });
+
+    if (!pipelineResult.success || !pipelineResult.report) {
+      console.warn(`âš ï¸ [ReporterPipeline] Pipeline failed: ${pipelineResult.error || 'No report generated'}`);
+      return null;
+    }
+
+    const durationMs = Date.now() - startTime;
+
+    // Build response text from report
+    let responseText = pipelineResult.report.markdown ?? '';
+
+    // Fallback to structured report if no markdown
+    if (!responseText) {
+      responseText = `# ${pipelineResult.report.title}

`;
+      responseText += `## ìš”ì•½
${pipelineResult.report.summary}

`;
+
+      if (pipelineResult.report.affectedServers.length > 0) {
+        responseText += `## ì˜í–¥ë°›ì€ ì„œë²„ (${pipelineResult.report.affectedServers.length}ëŒ€)
`;
+        for (const server of pipelineResult.report.affectedServers) {
+          responseText += `- **${server.name}** (${server.status}): ${server.primaryIssue}
`;
+        }
+        responseText += '
';
+      }
+
+      if (pipelineResult.report.rootCause) {
+        responseText += `## ê·¼ë³¸ ì›ì¸ ë¶„ì„
`;
+        responseText += `- **ì›ì¸**: ${pipelineResult.report.rootCause.cause}
`;
+        responseText += `- **ì‹ ë¢°ë„**: ${(pipelineResult.report.rootCause.confidence * 100).toFixed(0)}%
`;
+        responseText += `- **ì œì•ˆ**: ${pipelineResult.report.rootCause.suggestedFix}

`;
+      }
+
+      if (pipelineResult.report.suggestedActions.length > 0) {
+        responseText += `## ê¶Œì¥ ì¡°ì¹˜
`;
+        for (const action of pipelineResult.report.suggestedActions) {
+          responseText += `- ${action}
`;
+        }
```

## ğŸ“„ cloud-run/ai-engine/src/services/ai-sdk/agents/reporter-agent.ts

```diff
diff --git a/cloud-run/ai-engine/src/services/ai-sdk/agents/reporter-agent.ts b/cloud-run/ai-engine/src/services/ai-sdk/agents/reporter-agent.ts
index 8540b5366..f2c2c74a6 100644
--- a/cloud-run/ai-engine/src/services/ai-sdk/agents/reporter-agent.ts
+++ b/cloud-run/ai-engine/src/services/ai-sdk/agents/reporter-agent.ts
@@ -43,8 +43,6 @@ export function isReporterAgentAvailable(): boolean {
   return config?.getModel() !== null;
 }
 
-// Legacy export for compatibility (deprecated - use getReporterAgentConfig instead)
-export const reporterAgent = null;
 
 // ============================================================================
 // High-Quality Report Generation (Evaluator-Optimizer Pipeline)
@@ -85,5 +83,3 @@ export async function generateHighQualityReport(
   console.log(`ğŸ“‹ [Reporter] Generating high-quality report with pipeline...`);
   return executeReporterPipeline(query, options);
 }
-
-export default reporterAgent;
```

## ğŸ“„ cloud-run/ai-engine/src/services/ai-sdk/index.ts

```diff
diff --git a/cloud-run/ai-engine/src/services/ai-sdk/index.ts b/cloud-run/ai-engine/src/services/ai-sdk/index.ts
index 04f3b81e8..6a56d5ad8 100644
--- a/cloud-run/ai-engine/src/services/ai-sdk/index.ts
+++ b/cloud-run/ai-engine/src/services/ai-sdk/index.ts
@@ -12,7 +12,7 @@
 export {
   executeSupervisor,
   executeSupervisorStream,
-  classifyIntent,
+  createSupervisorStreamResponse,  // AI SDK Native UIMessageStream
   checkSupervisorHealth,
   type SupervisorRequest,
   type SupervisorResponse,
@@ -53,8 +53,8 @@ export {
   type PipelineConfig,
 } from './agents/reporter-pipeline';
 
-// Individual Agents
-export { nlqAgent } from './agents/nlq-agent';
-export { analystAgent } from './agents/analyst-agent';
-export { reporterAgent, generateHighQualityReport } from './agents/reporter-agent';
-export { advisorAgent } from './agents/advisor-agent';
+// Individual Agent Configs
+export { getNlqAgentConfig, isNlqAgentAvailable } from './agents/nlq-agent';
+export { getAnalystAgentConfig, isAnalystAgentAvailable } from './agents/analyst-agent';
+export { getReporterAgentConfig, isReporterAgentAvailable, generateHighQualityReport } from './agents/reporter-agent';
+export { getAdvisorAgentConfig, isAdvisorAgentAvailable } from './agents/advisor-agent';
```

## ğŸ“„ cloud-run/ai-engine/src/services/ai-sdk/supervisor.ts

```diff
diff --git a/cloud-run/ai-engine/src/services/ai-sdk/supervisor.ts b/cloud-run/ai-engine/src/services/ai-sdk/supervisor.ts
index b1ea37797..21a540b4e 100644
--- a/cloud-run/ai-engine/src/services/ai-sdk/supervisor.ts
+++ b/cloud-run/ai-engine/src/services/ai-sdk/supervisor.ts
@@ -13,7 +13,15 @@
  * @updated 2025-12-28
  */
 
-import { generateText, streamText, stepCountIs, type ModelMessage } from 'ai';
+import {
+  generateText,
+  streamText,
+  stepCountIs,
+  hasToolCall,
+  createUIMessageStream,
+  createUIMessageStreamResponse,
+  type ModelMessage,
+} from 'ai';
 import { getSupervisorModel, logProviderStatus, type ProviderName } from './model-provider';
 import { allTools, toolDescriptions, type ToolName } from '../../tools-ai-sdk';
 import { executeMultiAgent, executeMultiAgentStream, type MultiAgentRequest, type MultiAgentResponse } from './agents';
@@ -25,7 +33,6 @@ import {
   type TraceMetadata,
 } from '../observability/langfuse';
 import { getCircuitBreaker, CircuitOpenError } from '../resilience/circuit-breaker';
-import { SERVER_GROUP_PATTERN, FILTER_PATTERN } from '../../config/server-types';
 
 // ============================================================================
 // 1. Types
@@ -451,8 +458,8 @@ async function executeSupervisorAttempt(
 
       console.log(`ğŸ¤– [Supervisor] Using ${provider}/${modelId}`);
 
-      // Classify intent for tool optimization
-      const intent = classifyIntent(lastUserMessage?.content || '');
+      const queryText = lastUserMessage?.content || '';
+      const intentCategory = getIntentCategory(queryText);
 
       // Convert messages to ModelMessage format (AI SDK 6)
       const modelMessages: ModelMessage[] = [
@@ -463,23 +470,28 @@ async function executeSupervisorAttempt(
         })),
       ];
 
-      // Execute with multi-step tool calling and prepareStep optimization
-      // Reduced step count and tokens for faster responses (Vercel 60s limit)
+      // Execute with multi-step tool calling
+      // AI SDK v6 Best Practice:
+      // - prepareStep: Runtime tool filtering based on query intent
+      // - hasToolCall('finalAnswer'): Graceful loop termination
+      // - stepCountIs(3): Safety limit
       const result = await generateText({
         model,
         messages: modelMessages,
         tools: allTools,
-        stopWhen: stepCountIs(3), // Reduced from 5 to 3 for faster responses
-        temperature: 0.4, // Increased from 0.2 for more creative analysis
-        maxOutputTokens: 1536, // Reduced from 2048 for faster responses
-        // Note: prepareStep optimization moved to intent classification
-        // AI SDK v6 uses different approach - tools are filtered upfront
+        prepareStep: createPrepareStep(queryText),
+        stopWhen: [hasToolCall('finalAnswer'), stepCountIs(3)],
+        temperature: 0.4,
+        maxOutputTokens: 1536,
       });
 
       // Extract tool call information with Langfuse logging
       const toolsCalled: string[] = [];
       const toolResults: Record<string, unknown>[] = [];
 
+      // AI SDK v6 Best Practice: Extract finalAnswer response if called
+      let finalAnswerResult: { answer: string } | null = null;
+
       for (const step of result.steps) {
         for (const toolCall of step.toolCalls) {
           toolsCalled.push(toolCall.toolName);
@@ -491,11 +503,18 @@ async function executeSupervisorAttempt(
               toolResults.push(tr.result as Record<string, unknown>);
               // Log tool call to Langfuse
               logToolCall(trace, tr.toolName, {}, tr.result, 0);
+              // Check for finalAnswer tool result
+              if (tr.toolName === 'finalAnswer' && tr.result && typeof tr.result === 'object') {
+                finalAnswerResult = tr.result as { answer: string };
+              }
             }
           }
         }
       }
 
+      // Use finalAnswer if called, otherwise fall back to result.text
+      const response = finalAnswerResult?.answer ?? result.text;
+
       const durationMs = Date.now() - startTime;
 
       // Log generation to Langfuse
@@ -503,31 +522,31 @@ async function executeSupervisorAttempt(
         model: modelId,
         provider,
         input: lastUserMessage?.content || '',
-        output: result.text,
```

## ğŸ“„ cloud-run/ai-engine/src/tools-ai-sdk/final-answer.ts

```diff
diff --git a/cloud-run/ai-engine/src/tools-ai-sdk/final-answer.ts b/cloud-run/ai-engine/src/tools-ai-sdk/final-answer.ts
new file mode 100644
index 000000000..e381512ff
--- /dev/null
+++ b/cloud-run/ai-engine/src/tools-ai-sdk/final-answer.ts
@@ -0,0 +1,65 @@
+/**
+ * Final Answer Tool
+ *
+ * AI SDK v6 Best Practice: Use hasToolCall('finalAnswer') to terminate tool loops
+ * gracefully instead of relying solely on stepCountIs(N).
+ *
+ * This tool allows agents to explicitly signal when they have completed analysis
+ * and are ready to provide a final response.
+ *
+ * @version 1.0.0
+ * @created 2026-01-24
+ */
+
+import { z } from 'zod';
+import { tool } from 'ai';
+
+/**
+ * Final answer result type
+ */
+export interface FinalAnswerResult {
+  answer: string;
+  confidence: number;
+  toolsUsed: string[];
+  timestamp: string;
+}
+
+/**
+ * Final Answer Tool
+ *
+ * Agents should call this tool when analysis is complete to:
+ * 1. Signal loop termination via hasToolCall('finalAnswer')
+ * 2. Provide structured response metadata
+ * 3. Track confidence and tool usage
+ */
+export const finalAnswer = tool({
+  description:
+    'ìµœì¢… ì‘ë‹µì„ ì œì¶œí•©ë‹ˆë‹¤. ë¶„ì„ì´ ì™„ë£Œë˜ë©´ ë°˜ë“œì‹œ ì´ ë„êµ¬ë¥¼ í˜¸ì¶œí•˜ì„¸ìš”. ì´ ë„êµ¬ë¥¼ í˜¸ì¶œí•˜ë©´ ë„êµ¬ ë£¨í”„ê°€ ì¢…ë£Œë©ë‹ˆë‹¤.',
+  inputSchema: z.object({
+    answer: z.string().describe('ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í•  ìµœì¢… ì‘ë‹µ (ë§ˆí¬ë‹¤ìš´ í˜•ì‹ ì§€ì›)'),
+    confidence: z
+      .number()
+      .min(0)
+      .max(1)
+      .optional()
+      .describe('ì‘ë‹µ ì‹ ë¢°ë„ (0-1, ê¸°ë³¸ê°’: 0.8)'),
+    toolsUsed: z
+      .array(z.string())
+      .optional()
+      .describe('ë¶„ì„ì— ì‚¬ìš©ëœ ë„êµ¬ ëª©ë¡ (ìë™ ì¶”ì ìš©)'),
+  }),
+  execute: async ({
+    answer,
+    confidence,
+    toolsUsed,
+  }: {
+    answer: string;
+    confidence?: number;
+    toolsUsed?: string[];
+  }): Promise<FinalAnswerResult> => ({
+    answer,
+    confidence: confidence ?? 0.8,
+    toolsUsed: toolsUsed ?? [],
+    timestamp: new Date().toISOString(),
+  }),
+});
```

## ğŸ“„ cloud-run/ai-engine/src/tools-ai-sdk/index.ts

```diff
diff --git a/cloud-run/ai-engine/src/tools-ai-sdk/index.ts b/cloud-run/ai-engine/src/tools-ai-sdk/index.ts
index f76ab62bb..de9976207 100644
--- a/cloud-run/ai-engine/src/tools-ai-sdk/index.ts
+++ b/cloud-run/ai-engine/src/tools-ai-sdk/index.ts
@@ -74,6 +74,11 @@ export {
   incidentEvaluationTools,
 } from './incident-evaluation-tools';
 
+// ============================================================================
+// Final Answer Tool (AI SDK v6 Best Practice)
+// ============================================================================
+export { finalAnswer, type FinalAnswerResult } from './final-answer';
+
 // ============================================================================
 // Tool Collections (for Supervisor)
 // ============================================================================
@@ -83,6 +88,7 @@ import { checkThresholds, detectAnomalies, detectAnomaliesHybrid, detectAnomalie
 import { searchKnowledgeBase, recommendCommands, searchWeb } from './reporter-tools';
 import { calculateSLA, predictMetrics, analyzeServerCorrelation, generateIncidentReport } from './incident-report-tools';
 import { evaluateIncidentReport, validateReportStructure, scoreRootCauseConfidence, refineRootCauseAnalysis, enhanceSuggestedActions, extendServerCorrelation } from './incident-evaluation-tools';
+import { finalAnswer } from './final-answer';
 
 /**
  * All available tools for the AI SDK Supervisor
@@ -127,6 +133,9 @@ export const allTools = {
   refineRootCauseAnalysis,
   enhanceSuggestedActions,
   extendServerCorrelation,
+
+  // Final Answer (AI SDK v6 Best Practice - terminates tool loop)
+  finalAnswer,
 };
 
 /**
@@ -173,6 +182,9 @@ export const toolCategories = {
     enhanceSuggestedActions,
     extendServerCorrelation,
   },
+  control: {
+    finalAnswer,
+  },
 };
 
 /**
@@ -208,6 +220,8 @@ export const toolDescriptions = {
   refineRootCauseAnalysis: 'ë‚®ì€ ì‹ ë¢°ë„ ê·¼ë³¸ì›ì¸ ë¶„ì„ ì‹¬í™”',
   enhanceSuggestedActions: 'ê¶Œì¥ ì¡°ì¹˜ CLI ëª…ë ¹ì–´ í¬í•¨ êµ¬ì²´í™”',
   extendServerCorrelation: 'ì„œë²„ ê°„ ì—°ê´€ì„± ë¶„ì„ í™•ì¥',
+  // Control
+  finalAnswer: 'ìµœì¢… ì‘ë‹µ ì œì¶œ (ë„êµ¬ ë£¨í”„ ì¢…ë£Œ ì‹ í˜¸)',
 };
 
 export type ToolName = keyof typeof allTools;
```

---

## âœ¨ AI ë¦¬ë·° ê²°ê³¼

# Review Result: ìŠ¹ì¸ (Approved)

AI SDK v6ì˜ ìµœì‹  íŒ¨í„´(`hasToolCall`, `prepareStep`, `createUIMessageStream`)ì„ ì ì ˆíˆ ì ìš©í•˜ì—¬ ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ê³¼ ì‘ë‹µ í’ˆì§ˆì„ ë†’ì¸ ìš°ìˆ˜í•œ ë¦¬íŒ©í† ë§ì…ë‹ˆë‹¤. íŠ¹íˆ **Evaluator-Optimizer íŒ¨í„´** ë„ì…ê³¼ **Runtime Tool Filtering** ì ìš©ì€ ì‹¤ë¬´ì ìœ¼ë¡œ ë§¤ìš° ìœ ì˜ë¯¸í•œ ê°œì„ ì…ë‹ˆë‹¤.

ëª‡ ê°€ì§€ ê¶Œì¥ì‚¬í•­ì„ í¬í•¨í•˜ì—¬ ìŠ¹ì¸í•©ë‹ˆë‹¤.

## 1. ğŸ¯ ì£¼ìš” ê°œì„  ì‚¬í•­ (Strengths)

### **AI SDK v6 Best Practices ì ìš©**
- **`finalAnswer` ë„êµ¬ ë„ì…**: ê¸°ì¡´ì˜ ë¶ˆì•ˆì •í•œ `stepCountIs` ì˜ì¡´ì„±ì„ ì œê±°í•˜ê³ , ëª¨ë¸ì´ ëª…ì‹œì ìœ¼ë¡œ ì¢…ë£Œ ì‹œê·¸ë„ì„ ë³´ë‚´ë„ë¡ í•˜ì—¬ ì‘ë‹µì˜ ì™„ê²°ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤. (`supervisor.ts`, `final-answer.ts`)
- **`prepareStep` ìµœì í™”**: ì´ˆê¸° ë‹¨ê³„ì—ì„œ ì¿¼ë¦¬ ì˜ë„(`Intent`)ì— ë”°ë¼ ë„êµ¬ë¥¼ í•„í„°ë§í•˜ì—¬ í† í° ë¹„ìš©ì„ ì ˆê°í•˜ê³  ì •í™•ë„ë¥¼ ë†’ì´ë˜, `stepNumber > 0`ì¼ ë•ŒëŠ” ëª¨ë“  ë„êµ¬ë¥¼ ê°œë°©í•˜ì—¬ ìœ ì—°ì„±ì„ í™•ë³´í•œ ì „ëµì´ í›Œë¥­í•©ë‹ˆë‹¤. (`supervisor.ts`)

### **Reporter Pipeline ê³ ë„í™”**
- **Evaluator-Optimizer íŒ¨í„´**: ë¦¬í¬íŠ¸ í’ˆì§ˆì´ ê¸°ì¤€(`0.75`) ë¯¸ë‹¬ ì‹œ ìë™ìœ¼ë¡œ ê°œì„ (`Optimize Agent`)ì„ ìˆ˜í–‰í•˜ëŠ” ë¡œì§ì€ ìƒì„±í˜• AIì˜ í™˜ê°/ì˜¤ë¥˜ë¥¼ ì¤„ì´ëŠ” ê°•ë ¥í•œ íŒ¨í„´ì…ë‹ˆë‹¤. (`reporter-pipeline.ts`)

## 2. ğŸ” ì½”ë“œ í’ˆì§ˆ ë° ë¡œì§ ê²€í† 

### **`supervisor.ts`**
- **`createPrepareStep`**: `getIntentCategory`ì˜ Regex íŒ¨í„´ë“¤ì´ ì‹¤ë¬´ì ì¸ í•œêµ­ì–´ ì˜¤íƒ€(`ì¨ë²„`, `ë©”ë¨¸ë¦¬` ë“±)ê¹Œì§€ ì»¤ë²„í•˜ê³  ìˆì–´ ê²¬ê³ í•©ë‹ˆë‹¤.
- **Circuit Breaker**: `supervisor-${provider}`ë¡œ í”„ë¡œë°”ì´ë”ë³„ ê²©ë¦¬ëœ ì„œí‚· ë¸Œë ˆì´ì»¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ì ì´ ì•ˆì •ì„± ì¸¡ë©´ì—ì„œ ì¢‹ìŠµë‹ˆë‹¤.

### **`orchestrator.ts`**
- **Fallback Logic**: íŒŒì´í”„ë¼ì¸ ì‹¤íŒ¨ ì‹œ ë˜ëŠ” Markdown ëˆ„ë½ ì‹œ êµ¬ì¡°í™”ëœ ë°ì´í„°(`pipelineResult.report`)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì§ì ‘ Markdownì„ ì¬ì¡°ë¦½í•˜ëŠ” ë°©ì–´ ë¡œì§ì´ ì˜ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

### **`final-answer.ts`**
- **Type Safety**: `inputSchema`ì— `zod`ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì˜ ì¶œë ¥ í˜•ì‹ì„ ì—„ê²©í•˜ê²Œ ì •ì˜í•œ ì ì´ ì¢‹ìŠµë‹ˆë‹¤.

## 3. âš ï¸ ê¶Œì¥ ì‚¬í•­ (Recommendations)

### **1. Regex íŒ¨í„´ ìœ ë‹› í…ŒìŠ¤íŠ¸ ì¶”ê°€ (Testing)**
`supervisor.ts` ë‚´ë¶€ì˜ `selectExecutionMode`ì™€ `getIntentCategory`ì— ì‚¬ìš©ëœ ì •ê·œì‹ íŒ¨í„´ì´ ë³µì¡í•©ë‹ˆë‹¤. íŠ¹íˆ í•œêµ­ì–´ ì²˜ë¦¬ëŠ” ì—£ì§€ ì¼€ì´ìŠ¤ê°€ ë§ìœ¼ë¯€ë¡œ, ì£¼ìš” ì¿¼ë¦¬ íŒ¨í„´ì— ëŒ€í•œ ìœ ë‹› í…ŒìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•˜ì—¬ ì˜ë„ ë¶„ë¥˜ê°€ ì •í™•í•œì§€ ê²€ì¦í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

```typescript
// test/unit/intent-classification.test.ts (ê¶Œì¥)
test('should classify RCA intent correctly', () => {
  expect(getIntentCategory('ì¥ì•  ì›ì¸ ë¶„ì„í•´ì¤˜')).toBe('rca');
  expect(getIntentCategory('ì„œë²„ê°€ ì™œ ëŠë ¤?')).toBe('analyst'); // or rca based on rules
});
```

### **2. `classifyIntent` ì œê±° ì˜í–¥ë„ ì¬í™•ì¸**
`message-helpers.ts`ì—ì„œ `'classifyIntent': 'supervisor'` ë§¤í•‘ì´ ì¡´ì¬í•˜ì§€ë§Œ, ì´ëŠ” ë‹¨ìˆœ ë¬¸ìì—´ ë§¤í•‘ì´ë¯€ë¡œ í•¨ìˆ˜ ì œê±°(`export` ì‚­ì œ)ë¡œ ì¸í•œ ëŸ°íƒ€ì„ ì—ëŸ¬ëŠ” ì—†ì„ ê²ƒìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤. ë‹¤ë§Œ, í”„ë¡ íŠ¸ì—”ë“œ ì‚¬ì´ë“œì—ì„œ `thinkingSteps`ë¥¼ ë Œë”ë§í•  ë•Œ í•´ë‹¹ í‚¤ê°€ ìœ íš¨í•œì§€(ìƒˆë¡œìš´ ë¡œì§ì—ì„œë„ `classifyIntent`ë¼ëŠ” ë‹¨ê³„ëª…ì´ ìƒì„±ë˜ëŠ”ì§€) í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. 
> *ì°¸ê³ : ë³€ê²½ëœ ë¡œì§ì—ì„œëŠ” ëª…ì‹œì ì¸ `classifyIntent` ë„êµ¬ í˜¸ì¶œ ë‹¨ê³„ê°€ ì‚¬ë¼ì§€ê³  `prepareStep` ë‚´ë¶€ ë¡œì§ìœ¼ë¡œ í¡ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ UIì—ì„œ "ì˜ë„ ë¶„ì„ ì¤‘" ë‹¨ê³„ë¥¼ ë” ì´ìƒ ë³´ì—¬ì£¼ì§€ ëª»í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì˜ë„ëœ UX ë³€ê²½ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.*

### **3. API ë¬¸ì„œ í˜„í–‰í™”**
`createSupervisorStreamResponse` ë„ì…ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë° í”„ë¡œí† ì½œì´ AI SDK Native(`UIStream`) ë°©ì‹ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤. í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ ê°€ì´ë“œë‚˜ API ë¬¸ì„œë¥¼ ìµœì‹ í™”í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ ê°œë°œìê°€ í˜¼ë€ì„ ê²ªì§€ ì•Šë„ë¡ í•´ì£¼ì„¸ìš”.

## â­ ì¢…í•© ì˜ê²¬

ì´ ë³€ê²½ì‚¬í•­ì€ ì‹œìŠ¤í…œì˜ **ì•„í‚¤í…ì²˜ ì™„ì„±ë„**ë¥¼ ë†’ì´ê³  **ìœ ì§€ë³´ìˆ˜ì„±**ì„ ê°œì„ í•˜ëŠ” ëª¨ë²”ì ì¸ ë¦¬íŒ©í† ë§ì…ë‹ˆë‹¤. ë°°í¬ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤.

**ìŠ¹ì¸: âœ… Approved**

---

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ë²„ê·¸ ìœ„í—˜ ì‚¬í•­ í™•ì¸ ì™„ë£Œ
- [ ] ê°œì„  ì œì•ˆ ê²€í†  ì™„ë£Œ
- [ ] TypeScript ì•ˆì „ì„± í™•ì¸ ì™„ë£Œ
- [ ] ë³´ì•ˆ ì´ìŠˆ í™•ì¸ ì™„ë£Œ
- [ ] ì¢…í•© í‰ê°€ í™•ì¸ ì™„ë£Œ

## ğŸš¨ ì˜¤íƒ(False Positive) ê¸°ë¡

<!-- ê±°ë¶€/ì €ì ìˆ˜ê°€ ì˜¤íƒì¸ ê²½ìš° ì•„ë˜ì— ê¸°ë¡ -->
<!-- ì˜ˆì‹œ: - [x] limit ê²€ì¦ ì´ìŠˆ: Mock í•¸ë“¤ëŸ¬ë¼ ì‹¤ì œ ì˜í–¥ ì—†ìŒ -->


---

**ìƒì„± ì‹œê°„**: 2026-01-24 16:14:12
**ë¦¬ë·° íŒŒì¼**: `/mnt/d/cursor/openmanager-vibe-v5/reports/ai-review/pending/review-gemini-2026-01-24-16-08-15.md`
**AI ì—”ì§„**: GEMINI
