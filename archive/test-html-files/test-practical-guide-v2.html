<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ ì„œë²„ë³„ ì‹¤ë¬´ ê°€ì´ë“œ ì‹œìŠ¤í…œ v2.0</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 10px;
            color: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        select,
        input,
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        select:focus,
        input:focus,
        textarea:focus {
            outline: none;
            border-color: #4facfe;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .result-container {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #4facfe;
        }

        .guide-section {
            margin-bottom: 25px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .guide-section h3 {
            margin-top: 0;
            color: #667eea;
            border-bottom: 2px solid #e1e5e9;
            padding-bottom: 10px;
        }

        .command-item {
            background: #f1f3f4;
            padding: 10px;
            margin: 8px 0;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            border-left: 3px solid #4facfe;
        }

        .command-description {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
            font-family: 'Segoe UI', sans-serif;
        }

        .troubleshooting-item {
            background: #fff3cd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
        }

        .monitoring-metric {
            display: inline-block;
            background: #d4edda;
            padding: 5px 10px;
            margin: 3px;
            border-radius: 15px;
            font-size: 14px;
            border: 1px solid #c3e6cb;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #dc3545;
        }

        .server-type-badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .example-queries {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .example-query {
            background: white;
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .example-query:hover {
            background: #bbdefb;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-success {
            background: #28a745;
        }

        .status-warning {
            background: #ffc107;
        }

        .status-error {
            background: #dc3545;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ ì„œë²„ë³„ ì‹¤ë¬´ ê°€ì´ë“œ ì‹œìŠ¤í…œ v2.0</h1>
            <p>OpenManager Vibe v5 - ë£°ê¸°ë°˜ AI ì—”ì§„ + ì‹¤ë¬´ ê°€ì´ë“œ í†µí•©</p>
            <div id="systemStatus"></div>
        </div>

        <div class="form-group">
            <label for="serverType">ğŸ–¥ï¸ ì„œë²„ íƒ€ì… ì„ íƒ:</label>
            <select id="serverType">
                <option value="">ì„œë²„ íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš”</option>
                <option value="web">ğŸŒ ì›¹ì„œë²„ (Apache/Nginx)</option>
                <option value="database">ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ (MySQL/PostgreSQL)</option>
                <option value="cache">âš¡ ìºì‹œ ì„œë²„ (Redis/Memcached)</option>
                <option value="api">ğŸ”— API ì„œë²„ (Node.js/Python)</option>
                <option value="container">ğŸ³ ì»¨í…Œì´ë„ˆ (Docker/Kubernetes)</option>
                <option value="queue">ğŸ“¬ í ì„œë²„ (RabbitMQ/Kafka)</option>
                <option value="cdn">ğŸŒ CDN ì„œë²„</option>
                <option value="storage">ğŸ’¾ ìŠ¤í† ë¦¬ì§€ ì„œë²„</option>
            </select>
        </div>

        <div class="form-group">
            <label for="query">ğŸ’¬ ì§ˆë¬¸ ì…ë ¥:</label>
            <textarea id="query" rows="3"
                placeholder="ì˜ˆ: ì›¹ì„œë²„ ì¬ì‹œì‘í•˜ëŠ” ë°©ë²•, MySQL ëŠë ¤ì¡Œì–´ ì–´ë–»ê²Œ í™•ì¸í•´?, Redis ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸í•˜ê³  ì‹¶ì–´"></textarea>
        </div>

        <div class="example-queries">
            <h4>ğŸ“‹ ì˜ˆì œ ì§ˆë¬¸ë“¤:</h4>
            <div class="example-query" onclick="setExample('web', 'ì›¹ì„œë²„ ì¬ì‹œì‘í•˜ëŠ” ë°©ë²•')">ğŸŒ ì›¹ì„œë²„ ì¬ì‹œì‘í•˜ëŠ” ë°©ë²•</div>
            <div class="example-query" onclick="setExample('database', 'MySQL ëŠë ¤ì¡Œì–´, ì–´ë–»ê²Œ í™•ì¸í•´?')">ğŸ—„ï¸ MySQL ëŠë ¤ì¡Œì–´, ì–´ë–»ê²Œ í™•ì¸í•´?
            </div>
            <div class="example-query" onclick="setExample('cache', 'Redis ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸í•˜ê³  ì‹¶ì–´')">âš¡ Redis ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸í•˜ê³  ì‹¶ì–´
            </div>
            <div class="example-query" onclick="setExample('api', 'API ì„œë²„ ì‘ë‹µì´ ëŠë ¤')">ğŸ”— API ì„œë²„ ì‘ë‹µì´ ëŠë ¤</div>
            <div class="example-query" onclick="setExample('container', 'ë„ì»¤ ì»¨í…Œì´ë„ˆ ì‹œì‘ ì•ˆë¼')">ğŸ³ ë„ì»¤ ì»¨í…Œì´ë„ˆ ì‹œì‘ ì•ˆë¼</div>
        </div>

        <div class="button-group">
            <button class="btn-primary" onclick="testPracticalGuide()">ğŸ¯ ì‹¤ë¬´ ê°€ì´ë“œ ì¡°íšŒ</button>
            <button class="btn-secondary" onclick="testNaturalLanguage()">ğŸ§  ìì—°ì–´ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸</button>
            <button class="btn-secondary" onclick="checkSystemStatus()">ğŸ” ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸</button>
        </div>

        <div id="result" class="result-container" style="display: none;"></div>
    </div>

    <script>
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
        window.onload = function () {
            checkSystemStatus();
        };

        function setExample(serverType, query) {
            document.getElementById('serverType').value = serverType;
            document.getElementById('query').value = query;
        }

        async function checkSystemStatus() {
            const statusDiv = document.getElementById('systemStatus');
            statusDiv.innerHTML = '<span class="status-indicator status-warning"></span>ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ ì¤‘...';

            try {
                const response = await fetch('/api/ai/rule-based');
                const data = await response.json();

                if (data.success) {
                    const status = data.data.status;
                    const practicalGuide = data.data.practicalGuideSystem;

                    let statusHtml = `<span class="status-indicator status-success"></span>ì‹œìŠ¤í…œ ì •ìƒ (${status})`;

                    if (practicalGuide && practicalGuide.enabled) {
                        statusHtml += ` | ì‹¤ë¬´ ê°€ì´ë“œ í™œì„±í™” (${practicalGuide.supportedServerTypes.length}ê°œ ì„œë²„ íƒ€ì…)`;
                    }

                    statusDiv.innerHTML = statusHtml;
                } else {
                    statusDiv.innerHTML = '<span class="status-indicator status-error"></span>ì‹œìŠ¤í…œ ì˜¤ë¥˜';
                }
            } catch (error) {
                statusDiv.innerHTML = '<span class="status-indicator status-error"></span>ì—°ê²° ì‹¤íŒ¨';
            }
        }

        async function testPracticalGuide() {
            const serverType = document.getElementById('serverType').value;
            const query = document.getElementById('query').value;
            const resultDiv = document.getElementById('result');

            if (!serverType) {
                alert('ì„œë²„ íƒ€ì…ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }

            if (!query.trim()) {
                alert('ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading">ğŸ” ì‹¤ë¬´ ê°€ì´ë“œë¥¼ ì¡°íšŒí•˜ê³  ìˆìŠµë‹ˆë‹¤...</div>';

            try {
                const response = await fetch(`/api/ai/rule-based?practical=true&serverType=${encodeURIComponent(serverType)}&query=${encodeURIComponent(query)}`);
                const data = await response.json();

                console.log('ì‹¤ë¬´ ê°€ì´ë“œ ì‘ë‹µ:', data); // ë””ë²„ê¹…ìš©

                if (data.success) {
                    displayPracticalGuide(data.data);
                } else {
                    resultDiv.innerHTML = `<div class="error">âŒ ì˜¤ë¥˜: ${data.error || data.details || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}</div>`;
                }
            } catch (error) {
                console.error('ì‹¤ë¬´ ê°€ì´ë“œ ì¡°íšŒ ì˜¤ë¥˜:', error);
                resultDiv.innerHTML = `<div class="error">âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}</div>`;
            }
        }

        async function testNaturalLanguage() {
            const query = document.getElementById('query').value;
            const resultDiv = document.getElementById('result');

            if (!query.trim()) {
                alert('ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading">ğŸ§  ìì—°ì–´ ì²˜ë¦¬ ì¤‘...</div>';

            try {
                const response = await fetch('/api/ai/rule-based', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: query,
                        options: {
                            language: 'ko',
                            priority: 'balance'
                        }
                    })
                });

                const data = await response.json();
                console.log('ìì—°ì–´ ì²˜ë¦¬ ì‘ë‹µ:', data); // ë””ë²„ê¹…ìš©

                if (data.success) {
                    displayNaturalLanguageResult(data.data);
                } else {
                    resultDiv.innerHTML = `<div class="error">âŒ ì˜¤ë¥˜: ${data.error}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}</div>`;
            }
        }

        function displayPracticalGuide(data) {
            const { serverType, query, practicalGuide, supportedServerTypes } = data;
            let html = `
                <div class="server-type-badge">ğŸ–¥ï¸ ${serverType.toUpperCase()} ì„œë²„</div>
                <h2>ğŸ’¡ "${query}" - ì‹¤ë¬´ ê°€ì´ë“œ</h2>
            `;

            if (practicalGuide) {
                // ëª…ë ¹ì–´ ê°€ì´ë“œ
                if (practicalGuide.commands) {
                    html += `
                        <div class="guide-section">
                            <h3>ğŸ”§ ì£¼ìš” ëª…ë ¹ì–´</h3>
                    `;
                    Object.entries(practicalGuide.commands).forEach(([key, cmd]) => {
                        html += `
                            <div class="command-item">
                                <strong>${key}:</strong> ${cmd.command}
                                <div class="command-description">${cmd.description}</div>
                                ${cmd.example ? `<div class="command-description">ì˜ˆì œ: ${cmd.example}</div>` : ''}
                                ${cmd.caution ? `<div class="command-description">âš ï¸ ${cmd.caution}</div>` : ''}
                            </div>
                        `;
                    });
                    html += `</div>`;
                }

                // íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ
                if (practicalGuide.troubleshooting && practicalGuide.troubleshooting.length > 0) {
                    html += `
                        <div class="guide-section">
                            <h3>ğŸš¨ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ</h3>
                    `;
                    practicalGuide.troubleshooting.forEach(item => {
                        html += `
                            <div class="troubleshooting-item">
                                <h4>ì¦ìƒ: ${item.symptom}</h4>
                                <p><strong>ì§„ë‹¨ ë°©ë²•:</strong></p>
                                <ul>
                                    ${item.diagnosis.map(d => `<li>${d}</li>`).join('')}
                                </ul>
                                <p><strong>í•´ê²° ë°©ì•ˆ:</strong></p>
                                <ul>
                                    ${item.solution.map(s => `<li>${s}</li>`).join('')}
                                </ul>
                                ${item.prevention ? `<p><strong>ì˜ˆë°©ì±…:</strong> ${item.prevention}</p>` : ''}
                            </div>
                        `;
                    });
                    html += `</div>`;
                }

                // ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ
                if (practicalGuide.monitoring) {
                    html += `
                        <div class="guide-section">
                            <h3>ğŸ“Š ëª¨ë‹ˆí„°ë§ ê°€ì´ë“œ</h3>
                            <p><strong>í•µì‹¬ ë©”íŠ¸ë¦­:</strong></p>
                            <div>
                                ${practicalGuide.monitoring.key_metrics.map(metric =>
                        `<span class="monitoring-metric">${metric}</span>`
                    ).join('')}
                            </div>
                            <p><strong>ë¡œê·¸ ìœ„ì¹˜:</strong></p>
                            <ul>
                                ${practicalGuide.monitoring.log_locations.map(log => `<li>${log}</li>`).join('')}
                            </ul>
                            <p><strong>ì„±ëŠ¥ ì§€í‘œ:</strong></p>
                            <ul>
                                ${practicalGuide.monitoring.performance_indicators.map(indicator => `<li>${indicator}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
            } else {
                html += `
                    <div class="guide-section">
                        <h3>ğŸ“‹ ì§€ì›ë˜ëŠ” ì„œë²„ íƒ€ì…</h3>
                        <p>í˜„ì¬ ë‹¤ìŒ ì„œë²„ íƒ€ì…ë“¤ì— ëŒ€í•œ ì‹¤ë¬´ ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤:</p>
                        <div>
                            ${supportedServerTypes.map(type =>
                    `<span class="monitoring-metric">${type}</span>`
                ).join('')}
                        </div>
                    </div>
                `;
            }

            document.getElementById('result').innerHTML = html;
        }

        function displayNaturalLanguageResult(data) {
            const { query, intent, confidence, response, serverType, practicalGuide, processingTime, engineBreakdown } = data;

            let html = `
                <h2>ğŸ§  ìì—°ì–´ ì²˜ë¦¬ ê²°ê³¼</h2>
                <div class="guide-section">
                    <h3>ğŸ“ ì²˜ë¦¬ ê²°ê³¼</h3>
                    <p><strong>ì§ˆë¬¸:</strong> ${query}</p>
                    <p><strong>ì˜ë„:</strong> ${intent}</p>
                    <p><strong>ì‹ ë¢°ë„:</strong> ${Math.round(confidence * 100)}%</p>
                    <p><strong>ì‘ë‹µ:</strong> ${response}</p>
                    <p><strong>ì²˜ë¦¬ ì‹œê°„:</strong> ${processingTime}ms</p>
                    ${serverType ? `<p><strong>ê°ì§€ëœ ì„œë²„ íƒ€ì…:</strong> <span class="server-type-badge">${serverType}</span></p>` : ''}
                </div>
            `;

            if (engineBreakdown) {
                html += `
                    <div class="guide-section">
                        <h3>âš™ï¸ ì—”ì§„ë³„ ê¸°ì—¬ë„</h3>
                        <div>
                            ${Object.entries(engineBreakdown).map(([engine, score]) =>
                    `<span class="monitoring-metric">${engine}: ${Math.round(score * 100)}%</span>`
                ).join('')}
                        </div>
                    </div>
                `;
            }

            if (practicalGuide) {
                html += `
                    <div class="guide-section">
                        <h3>ğŸ¯ ì‹¤ë¬´ ê°€ì´ë“œ ì œì•ˆ</h3>
                        ${practicalGuide.quickCommands ? `
                            <p><strong>ë¹ ë¥¸ ëª…ë ¹ì–´:</strong></p>
                            <ul>
                                ${practicalGuide.quickCommands.map(cmd => `<li><code>${cmd}</code></li>`).join('')}
                            </ul>
                        ` : ''}
                        ${practicalGuide.troubleshootingTips ? `
                            <p><strong>íŠ¸ëŸ¬ë¸”ìŠˆíŒ… íŒ:</strong></p>
                            <ul>
                                ${practicalGuide.troubleshootingTips.map(tip => `<li>${tip}</li>`).join('')}
                            </ul>
                        ` : ''}
                        ${practicalGuide.monitoringMetrics ? `
                            <p><strong>ëª¨ë‹ˆí„°ë§ ë©”íŠ¸ë¦­:</strong></p>
                            <div>
                                ${practicalGuide.monitoringMetrics.map(metric =>
                    `<span class="monitoring-metric">${metric}</span>`
                ).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            document.getElementById('result').innerHTML = html;
        }
    </script>
</body>

</html>