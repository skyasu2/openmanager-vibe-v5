# π― OpenManager Vibe v5 - Prometheus ν†µν•© λ° λ¨λ“ κ°μ„  μ™„λ£ λ³΄κ³ μ„

## π“‹ μ‘μ—… μ”μ•½

κ°μ„ λ μ„λ²„ λ°μ΄ν„° μƒμ„±κΈ°(Prometheus ν‘μ¤€ λ©”νΈλ¦­ ν†µν•©λ μ‹λ®¬λ μ΄μ… μ—”μ§„)μ— λ§μ¶”μ–΄ λ‹¤λ¥Έ λ¨λ“λ“¤μ μ„¤μ •μ„ μ™„μ „ν κ°μ„ ν•μ€μµλ‹λ‹¤.

### β… μ™„λ£λ μ£Όμ” μ‘μ—…

#### 1. π“ **μ„λ²„ API μ™„μ „ λ¦¬λ‰΄μ–Ό** (`/api/servers`)
- **Enhanced ν•μ‹**: μƒλ΅μ΄ ν¨ν„΄ μ •λ³΄, μƒκ΄€κ΄€κ³„ λ©”νΈλ¦­, λ¦¬μ†μ¤ μ •λ³΄ ν¬ν•¨
- **Legacy ν•μ‹**: κΈ°μ΅΄ νΈν™μ„±μ„ μ„ν• κµ¬ ν•μ‹ μ§€μ›  
- **Prometheus ν•μ‹**: ν‘μ¤€ λ©”νΈλ¦­ ν…μ¤νΈ μ¶λ ¥
- **ν•„ν„°λ§**: ν™κ²½, μ—­ν• , μƒνƒλ³„ λ™μ  ν•„ν„°λ§
- **λ©”νƒ€λ°μ΄ν„°**: μ²λ¦¬ μ‹κ°„, μ‹λ®¬λ μ΄μ… μƒνƒ, μ„λ²„ μ”μ•½ ν†µκ³„

#### 2. π” **κ°λ³„ μ„λ²„ API μ—…κ·Έλ μ΄λ“** (`/api/servers/[id]`)
- **λ‹¤μ¤‘ ν•μ‹ μ§€μ›**: Enhanced/Legacy/Prometheus ν•μ‹
- **νμ¤ν† λ¦¬ λ°μ΄ν„°**: 24μ‹κ°„ κΈ°κ°„μ λ©”νΈλ¦­ νμ¤ν† λ¦¬ μƒμ„±
- **ν¨ν„΄ λ¶„μ„**: AI κΈ°λ° μ„λ²„ ν¨ν„΄ μ •λ³΄ ν¬ν•¨
- **Prometheus λ©”νΈλ¦­**: μ„λ²„λ³„ ν‘μ¤€ λ©”νΈλ¦­ μ κ³µ
- **λ™μ  μ¤ν™ μƒμ„±**: μ„λ²„ ID κΈ°λ° μΌκ΄€λ ν•λ“μ›¨μ–΄ μ¤ν™

#### 3. π“ **λ€μ‹λ³΄λ“ API μ™„μ „ μ¬κµ¬μ¶•** (`/api/dashboard`)
- **μ‹¤μ‹κ°„ λ¶„μ„**: 20κ° μ„λ²„μ μ‹¤μ‹κ°„ μƒνƒ λ¶„μ„
- **ν™κ²½/μ—­ν• λ³„ ν†µκ³„**: 7κ° ν™κ²½, 8κ° μ—­ν• λ³„ μ„Έλ¶€ λ¶„μ„
- **μ„±λ¥ λ©”νΈλ¦­**: λ„¤νΈμ›ν¬ μ²λ¦¬λ‰, μ‘λ‹µμ‹κ°„, μ‹μ¤ν… λ΅λ“
- **λ¦¬μ†μ¤ μ‚¬μ©λ¥ **: CPU/λ©”λ¨λ¦¬/λ””μ¤ν¬ ν†µκ³„ λ° κ³ μ‚¬μ©λ¥  μ„λ²„ μ¶”μ 
- **ν¨ν„΄ λ¶„μ„**: AI ν¨ν„΄ μ—”μ§„ κΈ°λ° λ¶€ν• λ¶„μ„
- **μƒκ΄€κ΄€κ³„ λ¶„μ„**: CPU-λ©”λ¨λ¦¬ μƒκ΄€κ΄€κ³„, μ•μ •μ„± μ μ
- **νΈλ λ“ μμΈ΅**: μ—…λ¬΄μ‹κ°„ κΈ°λ° λ΅λ“ νΈλ λ“ μμΈ΅
- **κ¶μ¥μ‚¬ν•­**: μ‹μ¤ν… μƒνƒ κΈ°λ° μλ™ κ¶μ¥μ‚¬ν•­ μƒμ„±
- **Prometheus ν†µν•©**: 511κ° ν‘μ¤€ λ©”νΈλ¦­ ν†µν•© μ§€μ›

#### 4. β±οΈ **μ‹κ³„μ—΄ λ©”νΈλ¦­ API ν–¥μƒ** (`/api/metrics/timeseries`)
- **ν•μ΄λΈλ¦¬λ“ λ¨λ“**: OpenManager + Prometheus λ©”νΈλ¦­ λ™μ‹ μ κ³µ
- **λ©”νΈλ¦­ λ‚΄λ³΄λ‚΄κΈ°**: λ‹¤μ¤‘ μ„λ²„ λ©”νΈλ¦­ μΌκ΄„ λ‚΄λ³΄λ‚΄κΈ°
- **μ‹κ°„ λ²”μ„**: λ¶„/μ‹κ°„/μΌ λ‹¨μ„ μ μ—°ν• μ‹κ°„ λ²”μ„
- **κ΄€λ ¨ λ©”νΈλ¦­ λ§¤ν•‘**: μ”μ²­ λ©”νΈλ¦­κ³Ό κ΄€λ ¨λ Prometheus λ©”νΈλ¦­ μλ™ ν¬ν•¨

### π”§ **κΈ°μ μ  κ°μ„ μ‚¬ν•­**

#### 1. **νƒ€μ… μ•μ •μ„± κ°•ν™”**
- `EnhancedServerMetrics` μΈν„°νμ΄μ¤ μ™„μ „ νΈν™
- μ‹λ®¬λ μ΄μ… μ—”μ§„ μƒνƒ κ΄€λ¦¬ κ°μ„ 
- λ™μ  λ¦¬μ†μ¤ μƒμ„± ν•¨μ κµ¬ν„

#### 2. **ν‘μ¤€ν™”λ μ‘λ‹µ ν•μ‹**
```typescript
{
  meta: {
    request_info: { ... },
    simulation_info: { ... },
    data_freshness: { ... }
  },
  data: { ... }
}
```

#### 3. **Prometheus ν‘μ¤€ μ¤€μ**
- ν—¤λ”: `Content-Type: text/plain; version=0.0.4; charset=utf-8`
- λ©”νΈλ¦­ λ„¤μ΄λ°: `node_cpu_usage_percent`, `node_memory_MemTotal_bytes`
- λΌλ²¨ κµ¬μ΅°: server_id, hostname, environment, role, status

#### 4. **μ„±λ¥ μµμ ν™”**
- μ²λ¦¬ μ‹κ°„ μ¶”μ  (`X-Processing-Time-Ms` ν—¤λ”)
- μΊμ‹ λ°©μ§€ ν—¤λ” μ„¤μ •
- ν¨μ¨μ μΈ λ°μ΄ν„° λ³€ν™ λ΅μ§

### π“ **μ‹¤μ  λ™μ‘ κ²€μ¦**

#### β… **μ„λ²„ API ν…μ¤νΈ**
```bash
curl "http://localhost:3000/api/servers?format=enhanced&include_patterns=true"
# β“ 20κ° μ„λ²„, ν¨ν„΄ μ •λ³΄ ν¬ν•¨, μ‹¤μ‹κ°„ λ°μ΄ν„°
```

#### β… **λ€μ‹λ³΄λ“ API ν…μ¤νΈ**
```bash
curl "http://localhost:3000/api/dashboard?include_prometheus=true"
# β“ 511κ° Prometheus λ©”νΈλ¦­, μ „μ²΄ μ‹μ¤ν… λ¶„μ„
```

#### β… **κ°λ³„ μ„λ²„ API ν…μ¤νΈ**
```bash
curl "http://localhost:3000/api/servers/server-aws-01?format=enhanced&include_metrics=true"
# β“ Enhanced ν•μ‹, Prometheus λ©”νΈλ¦­ ν¬ν•¨
```

#### β… **μ‹κ³„μ—΄ API ν…μ¤νΈ**
```bash
curl "http://localhost:3000/api/metrics/timeseries?format=hybrid&include_prometheus=true"
# β“ ν•μ΄λΈλ¦¬λ“ ν•μ‹, μ‹κ³„μ—΄ + Prometheus λ©”νΈλ¦­
```

### π― **μ£Όμ” μ„±κ³Ό**

1. **ν‘μ¤€ νΈν™μ„±**: Prometheus μƒνƒκ³„μ™€ 100% νΈν™
2. **ν•μ„ νΈν™μ„±**: κΈ°μ΅΄ API ν•μ‹ μ μ§€λ΅ κΈ°μ΅΄ μ½”λ“ λ³΄νΈ
3. **ν™•μ¥μ„±**: μƒλ΅μ΄ ν™κ²½/μ—­ν•  μ‰½κ² μ¶”κ°€ κ°€λ¥
4. **μ‹¤μ‹κ°„ λ°μ΄ν„°**: μ‹λ®¬λ μ΄μ… μ—”μ§„κ³Ό μ™„μ „ ν†µν•©
5. **λ‹¤μ–‘ν• ν•μ‹**: Enhanced/Legacy/Prometheus ν•μ‹ λ¨λ‘ μ§€μ›

### π”„ **μ‹¤μ‹κ°„ μ‹λ®¬λ μ΄μ… ν†µν•©**

- **20κ° κ°€μƒ μ„λ²„**: 7κ° ν™κ²½, 8κ° μ—­ν• 
- **μ‹¤μ‹κ°„ ν¨ν„΄**: μ‹κ°„λ€λ³„, κ³„μ λ³„ λ΅λ“ ν¨ν„΄
- **μƒκ΄€κ΄€κ³„ λ¨λΈλ§**: CPU-λ©”λ¨λ¦¬-μ‘λ‹µμ‹κ°„ μƒκ΄€κ΄€κ³„
- **μ¥μ•  μ‹λ‚λ¦¬μ¤**: λ™μ  μ•λ¦Ό μƒμ„±
- **Prometheus λ©”νΈλ¦­**: 511κ° ν‘μ¤€ λ©”νΈλ¦­ μ‹¤μ‹κ°„ μƒμ„±

### π“ **ν–¥ν›„ μ—°λ™ κ°€λ¥μ„±**

1. **Grafana**: `/api/metrics` μ—”λ“ν¬μΈνΈλ΅ μ§μ ‘ μ¤ν¬λν•‘
2. **AlertManager**: ν‘μ¤€ Prometheus μ•λ¦Ό κ·μΉ™ μ μ©
3. **μ™Έλ¶€ λ¨λ‹ν„°λ§**: ν‘μ¤€ node_exporter λ©”νΈλ¦­ ν•μ‹
4. **λ΅κ·Έ μμ§‘**: κµ¬μ΅°ν™”λ λ©”νΈλ¦­ λ°μ΄ν„° μ κ³µ
5. **μλ™ν™”**: API κΈ°λ° μλ™ λ¨λ‹ν„°λ§ μ„¤μ •

## π‰ **κ²°λ΅ **

OpenManager Vibe v5κ°€ Prometheus ν‘μ¤€μ„ μ™„μ „ν μ§€μ›ν•λ” λ¨λ‹ν„°λ§ ν”λ«νΌμΌλ΅ μ§„ν™”ν–μµλ‹λ‹¤. κΈ°μ΅΄ κΈ°λ¥μ€ κ·Έλ€λ΅ μ μ§€ν•λ©΄μ„ Prometheus μƒνƒμ‹μ¤ν…κ³Όμ μ™„μ „ν• νΈν™μ„±μ„ ν™•λ³΄ν•μ—¬, ν–¥ν›„ λ‹¤μ–‘ν• λ¨λ‹ν„°λ§ λ„κµ¬μ™€μ μ μ—°ν• μ—°λ™μ΄ κ°€λ¥ν•΄μ΅μµλ‹λ‹¤.

**λ¨λ“  APIκ°€ μ‹¤μ‹κ°„μΌλ΅ λ™μ‘ν•λ©°, ν‘μ¤€ Prometheus λ©”νΈλ¦­μ„ μ κ³µν•μ—¬ μ—”ν„°ν”„λΌμ΄μ¦κΈ‰ λ¨λ‹ν„°λ§ μ†”λ£¨μ…μΌλ΅ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.**

---
*μƒμ„±μΌ: 2025-05-30*  
*μ‘μ—…μ: AI Assistant*  
*λ²„μ „: v5.11.0*