#!/bin/sh

echo "ğŸš€ Pre-push ê²€ì¦ ì‹œì‘..."

# Skip if HUSKY is disabled
if [ "$HUSKY" = "0" ]; then
    echo "â­ï¸  Huskyê°€ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê²€ì¦ì„ ê±´ë„ˆëœë‹ˆë‹¤."
    exit 0
fi

# ë¹ ë¥¸ ê²€ì¦ ì‹¤í–‰ (íƒ€ì… ì²´í¬ + ì´ˆê³ ì† í…ŒìŠ¤íŠ¸) - 2025 í‘œì¤€
echo "âš¡ ë¹ ë¥¸ ê²€ì¦ ì‹¤í–‰ ì¤‘..."
npm run validate:commit
if [ $? -ne 0 ]; then
    echo "âŒ ë¹ ë¥¸ ê²€ì¦ ì‹¤íŒ¨!"
    echo "ğŸ’¡ ì˜µì…˜: HUSKY=0 git push (ê°•ì œ í‘¸ì‹œ)"
    
    # ëŒ€í™”í˜• ëª¨ë“œì—ì„œë§Œ ì„ íƒ ì˜µì…˜ ì œê³µ
    if [ -t 0 ]; then
        echo ""
        echo "ê·¸ë˜ë„ í‘¸ì‹œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N)"
        read -r response
        if [ "$response" = "y" ] || [ "$response" = "Y" ]; then
            exit 0
        fi
    fi
    
    exit 1
fi

echo "âœ… Pre-push ê²€ì¦ í†µê³¼!"
echo "ğŸš€ Pushë¥¼ ì§„í–‰í•©ë‹ˆë‹¤..."