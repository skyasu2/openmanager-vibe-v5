#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Pre-push validation started..."

# ê¸°ë³¸ JSON ë¬¸ë²• ê²€ì‚¬
echo "ğŸ“‹ Checking package.json syntax..."
node -e "JSON.parse(require('fs').readFileSync('package.json', 'utf8'))" > /dev/null 2>&1
if [ $? -ne 0 ]; then
  echo "âŒ package.json has syntax errors"
  exit 1
fi

# ë¯¼ê°í•œ íŒŒì¼ ì²´í¬
echo "ğŸ”’ Checking for sensitive files..."
if git diff --cached --name-only | grep -E '\.(env|key|pem)$'; then
  echo "âŒ ë¯¼ê°í•œ íŒŒì¼ë“¤(.env, .key, .pem)ì€ ì»¤ë°‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
  exit 1
fi

# Git ìƒíƒœ í™•ì¸
if [ -z "$(git status --porcelain)" ]; then
  echo "âš ï¸  Working directory is clean - nothing to push"
fi

echo "âœ… Pre-push validation completed in $(date +'%H:%M:%S')"
echo "ğŸš€ Basic security checks passed"
echo "ğŸ”„ Full TypeScript/ESLint validation will run in CI/CD"
