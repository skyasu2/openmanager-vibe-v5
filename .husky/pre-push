#!/bin/sh

echo "🚀 Pre-push 검증 시작..."

# Skip if HUSKY is disabled
if [ "$HUSKY" = "0" ]; then
    echo "⏭️  Husky가 비활성화되어 있습니다. 검증을 건너뜁니다."
    exit 0
fi

# 단순한 Pre-push 검증 (지능형 시스템 제거)
echo "📋 TypeScript 타입 체크 중..."
npm run type-check

if [ $? -ne 0 ]; then
    echo "❌ TypeScript 타입 에러가 있습니다!"
    echo "💡 해결책: npm run type-check 실행 후 수정"
    echo "   또는 HUSKY=0 git push (긴급시만)"
    exit 1
fi

echo "🧪 핵심 테스트 실행 중..."
npm run test:quick

if [ $? -ne 0 ]; then
    echo "❌ 테스트 실패!"
    echo "💡 해결책: npm test 실행 후 수정"
    echo "   또는 HUSKY=0 git push (긴급시만)"
    exit 1
fi

echo "✅ Pre-push 검증 완료!"
echo "🚀 Push를 진행합니다..."