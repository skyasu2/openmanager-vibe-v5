#!/bin/sh

echo "ğŸš€ Pre-push ê²€ì¦ ì‹œì‘..."

# Skip if HUSKY is disabled
if [ "$HUSKY" = "0" ]; then
    echo "â­ï¸  Huskyê°€ ë¹„í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê²€ì¦ì„ ê±´ë„ˆëœë‹ˆë‹¤."
    exit 0
fi

# ë‹¨ìˆœí•œ Pre-push ê²€ì¦ (ì§€ëŠ¥í˜• ì‹œìŠ¤í…œ ì œê±°)
echo "ğŸ“‹ TypeScript íƒ€ì… ì²´í¬ ì¤‘..."
npm run type-check

if [ $? -ne 0 ]; then
    echo "âŒ TypeScript íƒ€ì… ì—ëŸ¬ê°€ ìˆìŠµë‹ˆë‹¤!"
    echo "ğŸ’¡ í•´ê²°ì±…: npm run type-check ì‹¤í–‰ í›„ ìˆ˜ì •"
    echo "   ë˜ëŠ” HUSKY=0 git push (ê¸´ê¸‰ì‹œë§Œ)"
    exit 1
fi

echo "ğŸ§ª í•µì‹¬ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘..."
npm run test:quick

if [ $? -ne 0 ]; then
    echo "âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨!"
    echo "ğŸ’¡ í•´ê²°ì±…: npm test ì‹¤í–‰ í›„ ìˆ˜ì •"
    echo "   ë˜ëŠ” HUSKY=0 git push (ê¸´ê¸‰ì‹œë§Œ)"
    exit 1
fi

echo "âœ… Pre-push ê²€ì¦ ì™„ë£Œ!"
echo "ğŸš€ Pushë¥¼ ì§„í–‰í•©ë‹ˆë‹¤..."