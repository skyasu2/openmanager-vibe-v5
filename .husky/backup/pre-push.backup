#!/bin/sh
echo "Pre-push verification starting..."
echo "Running quality checks..."

# Skip if HUSKY is disabled
if [ "$HUSKY" = "0" ]; then
    echo "Husky is disabled. Skipping verification."
    exit 0
fi

# Type check
echo "Type checking..."
npm run type-check
if [ $? -ne 0 ]; then
    echo "Type check failed!"
    exit 1
fi

# Lint
echo "Linting..."
npm run lint
if [ $? -ne 0 ]; then
    echo "Lint check failed!"
    exit 1
fi

# Tests (unit tests only for pre-push)
echo "Running unit tests..."
npm run test:unit
if [ $? -ne 0 ]; then
    echo "Unit tests failed!"
    exit 1
fi

echo "All verifications passed! Proceeding with push."