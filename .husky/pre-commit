#!/bin/sh

# ğŸš€ ìŠ¤ë§ˆíŠ¸ Pre-commit Hook v2.0
# 
# íŠ¹ì§•:
# - íŒŒì¼ ìˆ˜ ê¸°ë°˜ ìë™ ëª¨ë“œ ì„ íƒ (minimal/fast/full)
# - ë‹¨ê³„ë³„ ê²€ì¦ (ë³´ì•ˆ â†’ êµ¬ë¬¸ â†’ í’ˆì§ˆ â†’ í…ŒìŠ¤íŠ¸)
# - ë¹ ë¥¸ ì‹¤íŒ¨ íŒ¨í„´ìœ¼ë¡œ íš¨ìœ¨ì„± ê·¹ëŒ€í™”
# - WSL2 í™˜ê²½ ìµœì í™”ëœ ìºì‹œ ì‚¬ìš©

# í™˜ê²½ ë³€ìˆ˜ë¡œ ìŠ¤í‚µ ê°€ëŠ¥
if [ "$HUSKY" = "0" ]; then
    echo "â­ï¸  HUSKY=0 ì„¤ì •ìœ¼ë¡œ ê²€ì¦ì„ ê±´ë„ˆëœë‹ˆë‹¤."
    exit 0
fi

# Node.js ìŠ¤ë§ˆíŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
echo "ğŸš€ ìŠ¤ë§ˆíŠ¸ Pre-commit ê²€ì¦ ì‹œì‘..."
node scripts/git/smart-pre-commit.js

# ìŠ¤í¬ë¦½íŠ¸ ê²°ê³¼ì— ë”°ë¼ ì²˜ë¦¬
exit_code=$?

if [ $exit_code -eq 0 ]; then
    echo "ğŸ‰ ìŠ¤ë§ˆíŠ¸ Pre-commit ì™„ë£Œ!"
else
    echo "âŒ Pre-commit ê²€ì¦ ì‹¤íŒ¨!"
    echo "ğŸ’¡ ë¹ ë¥¸ ì»¤ë°‹ ì˜µì…˜:"
    echo "   - HUSKY=0 git commit (ê²€ì¦ ì™„ì „ ìŠ¤í‚µ)"
    echo "   - npm run commit:fast (Husky ë¹„í™œì„±í™”)"
    echo "   - npm run commit:ultra-fast (ì¦‰ì‹œ í‘¸ì‹œ)"
fi

exit $exit_code