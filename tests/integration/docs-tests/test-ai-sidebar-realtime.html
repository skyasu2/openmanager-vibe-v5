<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ğŸ”— AI ì‚¬ì´ë“œë°” ì‹¤ì‹œê°„ ë°ì´í„° í…ŒìŠ¤íŠ¸</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
      }

      .content {
        padding: 30px;
      }

      .test-section {
        margin-bottom: 30px;
        padding: 20px;
        border: 2px solid #e1e5e9;
        border-radius: 15px;
        background: #f8f9fa;
      }

      .test-section h3 {
        color: #333;
        margin-bottom: 15px;
        font-size: 1.3rem;
      }

      .test-result {
        background: white;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 10px;
        border-left: 4px solid #ddd;
      }

      .test-result.success {
        border-left-color: #28a745;
        background: #f8fff9;
      }

      .test-result.error {
        border-left-color: #dc3545;
        background: #fff8f8;
      }

      .test-result.info {
        border-left-color: #17a2b8;
        background: #f8fcff;
      }

      .btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 10px;
        font-size: 1.1rem;
        cursor: pointer;
        margin: 10px;
        transition: transform 0.2s;
      }

      .btn:hover {
        transform: translateY(-2px);
      }

      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .progress-bar {
        width: 100%;
        height: 20px;
        background: #e9ecef;
        border-radius: 10px;
        overflow: hidden;
        margin: 10px 0;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #28a745, #20c997);
        width: 0%;
        transition: width 0.3s ease;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      .stat-card {
        background: white;
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .stat-number {
        font-size: 2rem;
        font-weight: bold;
        color: #667eea;
      }

      .stat-label {
        color: #666;
        margin-top: 5px;
      }

      .log-container {
        background: #1a1a1a;
        color: #00ff00;
        padding: 20px;
        border-radius: 10px;
        font-family: 'Courier New', monospace;
        height: 400px;
        overflow-y: auto;
        margin: 20px 0;
      }

      .log-entry {
        margin-bottom: 5px;
        padding: 2px 0;
      }

      .log-timestamp {
        color: #888;
      }

      .log-success {
        color: #00ff00;
      }

      .log-error {
        color: #ff4444;
      }

      .log-info {
        color: #44aaff;
      }

      .spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #667eea;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
        display: inline-block;
        margin-right: 10px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="header">
        <h1>ğŸ”— AI ì‚¬ì´ë“œë°” ì‹¤ì‹œê°„ ë°ì´í„° í…ŒìŠ¤íŠ¸</h1>
        <p>
          ë°±ì—”ë“œ APIì™€ì˜ ì‹¤ì œ í†µì‹ ì„ ê²€ì¦í•˜ê³  ì„œë²„ë°ì´í„° ìƒì„±ê¸°ì™€ ì—°ê²° í…ŒìŠ¤íŠ¸
        </p>
      </div>

      <div class="content">
        <!-- í…ŒìŠ¤íŠ¸ ì œì–´ -->
        <div class="test-section">
          <h3>ğŸ® í…ŒìŠ¤íŠ¸ ì œì–´</h3>
          <button id="startAllTests" class="btn">ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
          <button id="startMCPTest" class="btn">MCP ì¿¼ë¦¬ í…ŒìŠ¤íŠ¸</button>
          <button id="startInsightsTest" class="btn">AI ì¸ì‚¬ì´íŠ¸ í…ŒìŠ¤íŠ¸</button>
          <button id="startGoogleAITest" class="btn">
            Google AI ìƒíƒœ í…ŒìŠ¤íŠ¸
          </button>
          <button id="startServerDataTest" class="btn">
            ì„œë²„ë°ì´í„° ìƒì„±ê¸° í…ŒìŠ¤íŠ¸
          </button>
          <button id="startRealtimeTest" class="btn">
            ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸
          </button>
          <button id="clearLogs" class="btn" style="background: #dc3545">
            ë¡œê·¸ ì§€ìš°ê¸°
          </button>
        </div>

        <!-- ì§„í–‰ë¥  -->
        <div class="test-section">
          <h3>ğŸ“Š í…ŒìŠ¤íŠ¸ ì§„í–‰ë¥ </h3>
          <div class="progress-bar">
            <div id="progressFill" class="progress-fill"></div>
          </div>
          <div id="progressText">ëŒ€ê¸° ì¤‘...</div>
        </div>

        <!-- í†µê³„ -->
        <div class="test-section">
          <h3>ğŸ“ˆ í…ŒìŠ¤íŠ¸ í†µê³„</h3>
          <div class="stats-grid">
            <div class="stat-card">
              <div id="totalTests" class="stat-number">0</div>
              <div class="stat-label">ì „ì²´ í…ŒìŠ¤íŠ¸</div>
            </div>
            <div class="stat-card">
              <div id="passedTests" class="stat-number">0</div>
              <div class="stat-label">ì„±ê³µ</div>
            </div>
            <div class="stat-card">
              <div id="failedTests" class="stat-number">0</div>
              <div class="stat-label">ì‹¤íŒ¨</div>
            </div>
            <div class="stat-card">
              <div id="successRate" class="stat-number">0%</div>
              <div class="stat-label">ì„±ê³µë¥ </div>
            </div>
          </div>
        </div>

        <!-- ì‹¤ì‹œê°„ ë¡œê·¸ -->
        <div class="test-section">
          <h3>ğŸ“ ì‹¤ì‹œê°„ ë¡œê·¸</h3>
          <div id="logContainer" class="log-container">
            <div class="log-entry log-info">
              <span class="log-timestamp">[ì‹œì‘]</span> AI ì‚¬ì´ë“œë°” ì‹¤ì‹œê°„
              ë°ì´í„° í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ
            </div>
          </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ê²°ê³¼ -->
        <div class="test-section">
          <h3>ğŸ¯ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3>
          <div id="testResults">
            <div class="test-result info">
              í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ë ¤ë©´ ìœ„ì˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="test-ai-sidebar-realtime.js"></script>
    <script>
      // UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤
      function updateProgress(current, total) {
        const percentage = Math.round((current / total) * 100);
        document.getElementById('progressFill').style.width = percentage + '%';
        document.getElementById('progressText').textContent =
          `${current}/${total} í…ŒìŠ¤íŠ¸ ì™„ë£Œ (${percentage}%)`;
      }

      function updateStats(total, passed, failed) {
        document.getElementById('totalTests').textContent = total;
        document.getElementById('passedTests').textContent = passed;
        document.getElementById('failedTests').textContent = failed;

        const successRate = total > 0 ? Math.round((passed / total) * 100) : 0;
        document.getElementById('successRate').textContent = successRate + '%';
      }

      function addLog(message, type = 'info') {
        const logContainer = document.getElementById('logContainer');
        const timestamp = new Date().toLocaleTimeString('ko-KR');
        const logEntry = document.createElement('div');
        logEntry.className = `log-entry log-${type}`;
        logEntry.innerHTML = `<span class="log-timestamp">[${timestamp}]</span> ${message}`;

        logContainer.appendChild(logEntry);
        logContainer.scrollTop = logContainer.scrollHeight;
      }

      function addTestResult(testName, success, details = '') {
        const resultsContainer = document.getElementById('testResults');
        const resultDiv = document.createElement('div');
        resultDiv.className = `test-result ${success ? 'success' : 'error'}`;

        const status = success ? 'âœ…' : 'âŒ';
        resultDiv.innerHTML = `
                <strong>${status} ${testName}</strong>
                ${details ? `<br><small>${details}</small>` : ''}
            `;

        resultsContainer.appendChild(resultDiv);
      }

      function clearResults() {
        document.getElementById('testResults').innerHTML = '';
        updateProgress(0, 5);
        updateStats(0, 0, 0);
      }

      function setButtonsDisabled(disabled) {
        const buttons = document.querySelectorAll('.btn:not(#clearLogs)');
        buttons.forEach(btn => (btn.disabled = disabled));
      }

      // ê°œì„ ëœ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤
      class EnhancedAISidebarTest extends AISidebarRealtimeTest {
        constructor() {
          super();
          this.currentTest = 0;
          this.totalTests = 5;
        }

        async runTestWithUI(testName, testFunction) {
          addLog(`${testName} ì‹œì‘...`, 'info');

          try {
            const result = await testFunction.call(this);
            this.currentTest++;
            updateProgress(this.currentTest, this.totalTests);

            if (result) {
              addLog(`${testName} ì„±ê³µ`, 'success');
              addTestResult(testName, true);
            } else {
              addLog(`${testName} ì‹¤íŒ¨`, 'error');
              addTestResult(testName, false);
            }

            this.updateStatsUI();
            return result;
          } catch (error) {
            addLog(`${testName} ì˜¤ë¥˜: ${error.message}`, 'error');
            addTestResult(testName, false, error.message);
            this.currentTest++;
            updateProgress(this.currentTest, this.totalTests);
            this.updateStatsUI();
            return false;
          }
        }

        updateStatsUI() {
          const passed = Object.values(this.testResults).filter(r => r).length;
          const failed = Object.values(this.testResults).filter(r => !r).length;
          const total = passed + failed;
          updateStats(total, passed, failed);
        }

        async runAllTestsWithUI() {
          clearResults();
          setButtonsDisabled(true);
          this.currentTest = 0;

          addLog('ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');

          await this.runTestWithUI('MCP ì¿¼ë¦¬ ì‹œìŠ¤í…œ', this.testMCPQuery);
          await this.runTestWithUI('AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„°', this.testAIInsights);
          await this.runTestWithUI(
            'Google AI ìƒíƒœ ëª¨ë‹ˆí„°ë§',
            this.testGoogleAIStatus
          );
          await this.runTestWithUI(
            'ì„œë²„ë°ì´í„° ìƒì„±ê¸° ì—°ê²°',
            this.testServerDataGenerator
          );
          await this.runTestWithUI('ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸', this.testRealTimeUpdates);

          addLog('ì „ì²´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'success');
          setButtonsDisabled(false);

          // ìµœì¢… ê²°ê³¼ ìš”ì•½
          const passed = Object.values(this.testResults).filter(r => r).length;
          const total = Object.keys(this.testResults).length;
          const successRate = Math.round((passed / total) * 100);

          if (successRate >= 80) {
            addLog('ğŸŒŸ ìš°ìˆ˜í•œ ì„±ëŠ¥! í”„ë¡œë•ì…˜ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ', 'success');
          } else if (successRate >= 60) {
            addLog('âš ï¸ ì¼ë¶€ ê°œì„  í•„ìš”, ì¶”ê°€ ë””ë²„ê¹… ê¶Œì¥', 'info');
          } else {
            addLog('ğŸ”§ ìƒë‹¹í•œ ë¬¸ì œ ë°œê²¬, ì‹œìŠ¤í…œ ì ê²€ í•„ìš”', 'error');
          }
        }
      }

      // í…ŒìŠ¤íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
      const enhancedTester = new EnhancedAISidebarTest();

      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
      document.getElementById('startAllTests').addEventListener('click', () => {
        enhancedTester.runAllTestsWithUI();
      });

      document
        .getElementById('startMCPTest')
        .addEventListener('click', async () => {
          clearResults();
          await enhancedTester.runTestWithUI(
            'MCP ì¿¼ë¦¬ ì‹œìŠ¤í…œ',
            enhancedTester.testMCPQuery
          );
        });

      document
        .getElementById('startInsightsTest')
        .addEventListener('click', async () => {
          clearResults();
          await enhancedTester.runTestWithUI(
            'AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„°',
            enhancedTester.testAIInsights
          );
        });

      document
        .getElementById('startGoogleAITest')
        .addEventListener('click', async () => {
          clearResults();
          await enhancedTester.runTestWithUI(
            'Google AI ìƒíƒœ ëª¨ë‹ˆí„°ë§',
            enhancedTester.testGoogleAIStatus
          );
        });

      document
        .getElementById('startServerDataTest')
        .addEventListener('click', async () => {
          clearResults();
          await enhancedTester.runTestWithUI(
            'ì„œë²„ë°ì´í„° ìƒì„±ê¸° ì—°ê²°',
            enhancedTester.testServerDataGenerator
          );
        });

      document
        .getElementById('startRealtimeTest')
        .addEventListener('click', async () => {
          clearResults();
          await enhancedTester.runTestWithUI(
            'ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸',
            enhancedTester.testRealTimeUpdates
          );
        });

      document.getElementById('clearLogs').addEventListener('click', () => {
        document.getElementById('logContainer').innerHTML = '';
        addLog('ë¡œê·¸ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.', 'info');
      });

      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
      window.addEventListener('load', () => {
        addLog('AI ì‚¬ì´ë“œë°” ì‹¤ì‹œê°„ ë°ì´í„° í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ', 'success');
        addLog('í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ë ¤ë©´ ìœ„ì˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.', 'info');
      });
    </script>
  </body>
</html>
