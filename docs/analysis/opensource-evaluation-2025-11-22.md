# 오픈소스 도입 여부 평가 및 권장사항

**작성 일시**: 2025-11-22
**목적**: Google AI API 직접 호출 전환 후 새로운 오픈소스 도입 필요성 검토

---

## 📊 현재 시스템 구성 (2025-11-22 기준)

### 1. AI 핵심 기술 스택

| 기술                       | 버전    | 용도                      | 상태            |
| -------------------------- | ------- | ------------------------- | --------------- |
| **@google/generative-ai**  | ^0.24.1 | Gemini 2.0 Flash Lite API | ✅ 안정적       |
| **@supabase/supabase-js**  | ^2.48.0 | pgvector 기반 RAG         | ✅ 무료 티어 3% |
| **GCP Functions** (Python) | -       | Korean NLP + ML 분석      | ✅ 무료 티어 내 |

### 2. 보조 기술

| 기술                      | 버전    | 용도                        | 활용도 |
| ------------------------- | ------- | --------------------------- | ------ |
| **@tanstack/react-query** | ^5.66.1 | 데이터 fetching & 캐싱      | 높음   |
| **@vitest/ui**            | ^3.2.4  | 테스트 시각화 (이미 설치됨) | 낮음   |
| **@playwright/test**      | ^1.49.1 | E2E 테스트 (UI 내장)        | 높음   |

---

## 🔍 오픈소스 도입 고려 영역 분석

### 영역 1: 한국어 NLP 라이브러리 (JavaScript)

**현재 상태**:

- GCP Function: `enhanced-korean-nlp` (Python 기반)
- 6-Phase 파이프라인: Tokenization, Normalization, Entity Extraction, Intent Classification, Domain Enhancement
- 10분 TTL 캐싱, 무료 티어 내 안정 작동

**도입 가능 대안**:

- `mecab-ko-dic-node`: MeCab 형태소 분석기 (Node.js 바인딩)
- `korean-tokenizer`: JavaScript 한국어 토크나이저
- `hangul-js`: 한글 자모 분리/결합

**평가**:
| 항목 | 현재 (GCP Python) | 대안 (JS 라이브러리) |
|------|-------------------|----------------------|
| 정확도 | ⭐⭐⭐⭐⭐ (KoNLPy 생태계) | ⭐⭐⭐ (제한적) |
| 유지보수 | 쉬움 (Python 생태계) | 어려움 (커뮤니티 작음) |
| 성능 | 우수 (C 바인딩) | 보통 (Pure JS) |
| 비용 | $0 (무료 티어) | $0 |

**권장사항**: ❌ **도입 불필요**

- **이유**: Python 기반 NLP 생태계가 훨씬 성숙, 현재 시스템 안정적
- **무료 티어 충분**: 10분 캐싱으로 호출 횟수 최소화

---

### 영역 2: ML 분석 라이브러리 (JavaScript)

**현재 상태**:

- GCP Function: `ml-analytics-engine` (scikit-learn 기반)
- 기능: Anomaly Detection (3-sigma), Trend Analysis (선형회귀), Pattern Recognition
- 5분 TTL 캐싱, 무료 티어 내 안정 작동

**도입 가능 대안**:

- `TensorFlow.js`: 머신러닝 프레임워크
- `Brain.js`: 신경망 라이브러리
- `ml.js`: 범용 ML 라이브러리
- `simple-statistics`: 통계 라이브러리 (가벼움)

**평가**:
| 항목 | 현재 (scikit-learn) | 대안 (TensorFlow.js/ml.js) |
|------|---------------------|----------------------------|
| 통계 분석 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 번들 크기 | 0 (서버 사이드) | 큼 (500KB+) |
| 성능 | 우수 (NumPy) | 보통 (WebAssembly 필요) |
| 비용 | $0 (무료 티어) | $0 (번들 비용만) |

**권장사항**: ❌ **도입 불필요**

- **이유**: 통계 분석(3-sigma, 선형회귀)은 Python/NumPy가 최적
- **번들 크기**: TensorFlow.js 도입 시 500KB+ 증가
- **현재 성능 충분**: 5분 캐싱으로 효율적 운영

---

### 영역 3: AI 프레임워크/래퍼

#### 3-1. LangChain.js

**개요**: AI 체인 구축 프레임워크 (OpenAI, Anthropic, Google AI 지원)

**장점**:

- ✅ 표준화된 패턴 (Chain, Agent, Memory)
- ✅ 강력한 커뮤니티 및 문서
- ✅ RAG 구축 헬퍼 (벡터 스토어 통합)
- ✅ Streaming, Caching 내장

**단점**:

- ❌ 학습 곡선 높음
- ❌ 무거움 (300KB+ 번들)
- ❌ 현재 Provider 패턴으로 충분히 해결 가능

**현재 vs LangChain 비교**:
| 항목 | 현재 (Provider 패턴) | LangChain.js |
|------|----------------------|--------------|
| 구현 복잡도 | 낮음 (직접 제어) | 높음 (프레임워크 학습) |
| 번들 크기 | 최소화 | 300KB+ |
| 커스터마이징 | 완전 자유 | 제약 있음 |
| 유지보수 | 직접 관리 | 의존성 추가 |

**권장사항**: ❌ **도입 불필요**

- **이유**: 현재 Provider 패턴 (RAG, ML, KoreanNLP, Rule) 효과적 작동
- **불필요한 복잡도**: 간단한 AI 쿼리 처리에 프레임워크 오버스펙
- **향후 고려**: RAG 체인이 복잡해지면 검토 (현재는 불필요)

---

#### 3-2. Vercel AI SDK (@vercel/ai)

**개요**: Vercel 공식 AI 라이브러리 (OpenAI, Anthropic, Google AI 지원)

**장점**:

- ✅ React 통합 (`useChat`, `useCompletion` hooks)
- ✅ 스트리밍 최적화 (Server-Sent Events)
- ✅ UI 헬퍼 (메시지 포맷팅, 에러 처리)
- ✅ Vercel 플랫폼 최적화

**단점**:

- ❌ 다수 모델 지원 (현재 Google AI만 사용) → 오버스펙
- ❌ 80KB+ 번들 크기 (현재 최소화 전략과 충돌)

**현재 vs Vercel AI SDK 비교**:
| 항목 | 현재 (직접 구현) | Vercel AI SDK |
|------|------------------|---------------|
| 스트리밍 구현 | 수동 (fetch + SSE) | 자동 (hooks) |
| 번들 크기 | 최소 | 80KB+ |
| React 통합 | 수동 상태 관리 | 자동 (hooks) |
| Google AI 전용 | ✅ | ❌ (다수 모델) |

**권장사항**: ⚠️ **선택적 도입 검토**

- **현재 시점**: ❌ 도입 불필요 - 직접 구현으로 충분
- **향후 검토 시점**: 스트리밍 응답 개선 필요 시
  - 예: 실시간 AI 채팅 기능 추가
  - 예: 긴 응답(2000자+) 사용자 경험 개선
- **도입 조건**: 스트리밍 UX가 핵심 기능이 될 때

---

### 영역 4: 에러 추적 & 모니터링

#### 4-1. Sentry (에러 추적)

**개요**: 프로덕션 에러 추적 및 모니터링 플랫폼

**장점**:

- ✅ 실시간 에러 추적 (스택 트레이스, 브레드크럼)
- ✅ 에러 알림 (Slack, Email)
- ✅ 성능 모니터링 (트랜잭션 추적)
- ✅ Next.js 공식 지원

**단점**:

- ❌ 유료 (무료: 5,000 events/월)
- ❌ 프라이버시 고려 필요 (사용자 데이터 수집)

**도입 판단**:
| 현재 상황 | Sentry 필요성 |
|-----------|---------------|
| 테스트 통과율 88.9% | 낮음 (대부분 모킹 이슈) |
| 프로덕션 트래픽 낮음 | 낮음 (콘솔 로그 충분) |
| 사용자 피드백 없음 | 낮음 (에러 발생 빈도 낮음) |

**권장사항**: ⏸️ **향후 검토**

- **현재 시점**: ❌ 도입 불필요 - 콘솔 로그 + Vercel 로그 충분
- **향후 검토 시점**:
  - 프로덕션 에러가 자주 발생할 때
  - 사용자가 100명 이상 증가할 때
  - 디버깅이 어려운 에러가 반복될 때

---

#### 4-2. LogRocket (세션 재생)

**개요**: 사용자 세션 재생 및 행동 추적 도구

**장점**:

- ✅ 사용자 행동 추적 (클릭, 스크롤, 입력)
- ✅ 에러 발생 시 전체 세션 재생
- ✅ 성능 메트릭 (FCP, LCP, CLS)

**단점**:

- ❌ 유료 (무료: 1,000 sessions/월)
- ❌ **프라이버시 이슈**: 모든 사용자 행동 기록
- ❌ 번들 크기 증가 (50KB+)

**권장사항**: ❌ **도입 불필요**

- **이유**: 프라이버시 우선 정책 - 사용자 행동 추적 최소화
- **대안**: Vercel Analytics (기본 제공, 익명 데이터)

---

### 영역 5: 테스트 도구 (이미 사용 가능)

#### 5-1. Vitest UI

**현재 상태**: ✅ **이미 설치됨** (`@vitest/ui` ^3.2.4)

**활용 방법**:

```bash
npm run test:watch  # UI 자동 실행
```

**기능**:

- 테스트 실행 결과 시각화
- 실패한 테스트 필터링
- 커버리지 리포트

**권장사항**: ✅ **활성화 권장** (개발 도구로만)

- 테스트 디버깅 시 UI 모드 사용
- **Production 빌드에 포함되지 않음** (devDependencies)

---

#### 5-2. Playwright UI (Playwright Inspector)

**현재 상태**: ✅ **내장 기능** (별도 설치 불필요)

**활용 방법**:

```bash
npx playwright test --ui          # UI 모드
npx playwright test --headed      # 브라우저 표시
npx playwright test --debug       # 디버그 모드
```

**권장사항**: ✅ **활성화 권장** (E2E 디버깅 시)

- E2E 테스트 실패 시 `--ui` 모드로 디버깅
- **Production 영향 없음** (개발 전용)

---

## 📋 종합 권장사항

### ✅ 유지 (변경 불필요)

| 항목                       | 이유                                      | 우선순위 |
| -------------------------- | ----------------------------------------- | -------- |
| **GCP Functions (Python)** | 한국어 NLP + ML 분석 최적, 무료 티어 충분 | 높음     |
| **@google/generative-ai**  | Gemini API 직접 호출, 안정적              | 높음     |
| **Provider 패턴**          | 간결하고 효과적, 프레임워크 불필요        | 높음     |
| **Supabase pgvector**      | RAG 안정적 작동, 무료 티어 3%             | 높음     |

---

### ⚠️ 선택적 검토 (필요 시 도입)

| 항목              | 도입 조건                     | 예상 시점     | 우선순위 |
| ----------------- | ----------------------------- | ------------- | -------- |
| **Vercel AI SDK** | 스트리밍 응답 UX 개선 필요 시 | 향후 6개월+   | 낮음     |
| **Sentry**        | 프로덕션 에러 빈도 증가 시    | 사용자 100명+ | 중간     |

---

### ❌ 도입 불필요

| 항목                 | 이유                                     |
| -------------------- | ---------------------------------------- |
| **LangChain.js**     | 현재 Provider 패턴 충분, 불필요한 복잡도 |
| **JS 한국어 NLP**    | Python 생태계가 우수, 성능 우려          |
| **JS ML 라이브러리** | scikit-learn 최적, 번들 크기 증가        |
| **LogRocket**        | 프라이버시 이슈, 불필요한 추적           |

---

### ✅ 이미 사용 가능 (활성화 권장)

| 항목              | 활용 방법                                | 영향           |
| ----------------- | ---------------------------------------- | -------------- |
| **Vitest UI**     | `npm run test:watch` (개발 전용)         | 없음 (devDeps) |
| **Playwright UI** | `npx playwright test --ui` (디버깅 전용) | 없음 (내장)    |

---

## 🎯 결론 및 액션 아이템

### 핵심 메시지

1. **✅ 현재 시스템 유지 권장**
   - Google AI API + GCP Functions + Supabase 조합 안정적
   - 무료 티어 충분 (Vercel 30%, Supabase 3%, GCP 무료)
   - 불필요한 오픈소스 도입 → 복잡도 증가 방지

2. **🎯 선택적 검토 항목 (향후 6개월+)**
   - **Vercel AI SDK**: 스트리밍 UX 개선 필요 시
   - **Sentry**: 프로덕션 에러 추적 필요 시

3. **🚫 도입 불필요 항목**
   - LangChain.js, JS 한국어 NLP, JS ML 라이브러리, LogRocket
   - 이유: 현재 시스템 충분, 성능/프라이버시/복잡도 우려

---

### 다음 단계 (Phase 1 완료 후)

1. ✅ **완료**: GCP Functions 정리 (Phase 1 코드 클린업)
2. ⏸️ **보류**: 환경 변수 정리 (NEXT_PUBLIC_GCP_UNIFIED_AI_ENDPOINT 제거)
3. ⏸️ **보류**: 헬스 체크 스크립트 업데이트
4. 🔄 **진행 중**: 테스트 실패 57개 해결 (Vitest 모킹 API)
5. 📅 **예정 (1주일 후)**: Phase 2 - 실제 GCP Functions 삭제 (백업 후)

---

## 📚 참고 문서

- **GCP Functions 분석**: `docs/analysis/gcp-functions-analysis-2025-11-22.md`
- **AI 엔진 상태**: `docs/analysis/ai-engine-comprehensive-status-2025-11-22.md`
- **프로젝트 현황**: `docs/status.md`

---

**작성자**: Claude Code
**검토 날짜**: 2025-11-22
**다음 재검토 예정**: 2025-12-22 (1개월 후, 트래픽 및 에러율 모니터링 후)
