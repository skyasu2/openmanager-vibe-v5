# Multi-AI MCP v3.6.0 교차검증 결과

**검증 일시**: 2025-10-08 01:21 KST
**검증 대상**: v3.6.0 타임아웃 안전 마진 확대 (Codex 240s, Gemini 420s, Qwen 420s)
**검증 방법**: MCP 도구 + Bash CLI 병렬 실행

---

## 🎯 검증 목표

v3.6.0에서 단일 타임아웃 방식을 유지하면서 타임아웃 값을 증가시킨 변경사항이 실제로:
1. 안정성을 향상시켰는지
2. 3-AI가 모두 정상 작동하는지
3. 타임아웃 값이 적절한지

---

## 📊 테스트 결과

### 1. MCP 도구 테스트

**테스트 쿼리**:
- Codex: "Multi-AI MCP v3.6.0 타임아웃 개선 평가: Codex 240s, Gemini 420s, Qwen 420s. 실무 관점에서 이 타임아웃 값들이 적절한지 평가해주세요."
- Gemini: "Multi-AI MCP v3.6.0 타임아웃 설계 평가: 단일 타임아웃 구조(복잡도 감지 제거), P99 기반 안전 계수 적용. 아키텍처 관점에서 평가해주세요."
- Qwen: "Multi-AI MCP v3.6.0 성능 분석: Codex P99 168s→240s, Gemini P99 78s→420s, Qwen P99 92s→420s. 타임아웃 오버헤드와 최적화 가능성을 평가해주세요."

**결과**:
| AI | 상태 | 응답시간 | 토큰 | 결과 |
|----|------|----------|------|------|
| **Codex** | ✅ 성공 | 13.1s | 3,223 | 완전한 평가 제공 |
| **Gemini** | ❌ 실패 | - | - | MCP error -32001: Request timed out |
| **Qwen** | ❌ 실패 | - | - | MCP error -32001: Request timed out |

### 2. Bash CLI 병렬 테스트

**테스트 쿼리** (단순화):
- Codex: "v3.6.0 평가: 240초 적절성"
- Gemini: "v3.6.0 평가: 단순 구조"
- Qwen: "v3.6.0 평가: 420초 성능"

**결과**:
| AI | 상태 | 결과 | 비고 |
|----|------|------|------|
| **Codex** | ✅ 성공 | 완전한 응답 | 3,333 토큰, 실무적 조언 제공 |
| **Gemini** | ❌ 실패 | API 에러 | "Error when talking to Gemini API" |
| **Qwen** | ⚠️ 불완전 | 부분 응답 | 쿼리 이해 부족, 응답 미완료 |

---

## 🔍 Codex 평가 결과 (유일한 완전 응답)

**Codex의 v3.6.0 타임아웃 평가**:

### 긍정적 측면
- 240초는 기존 120초(재시도 시 180초) 대비 여유 있음

### 우려 사항
1. **검증 필요성**:
   - `logs/ai-perf/` 로그에서 실제 P95/P99 확인
   - 180초를 넘는 케이스가 실제로 얼마나 되는지 검증

2. **성능 트레이드오프**:
   - 240초 타임아웃은 세션 슬롯을 오래 점유
   - 동시 작업성과 비용 효율 저하 가능성
   - 재시도 로직(현재 1회) 또는 쿼리 분할 검토 필요

3. **근본 원인 분석**:
   - 타임아웃 원인이 Codex 자체인지, 네트워크/WSL I/O 지연인지 구분 필요

### 권장사항
- 실제 로그로 210~220초 근처 완료 케이스 확인
- 타임아웃 전에 응답이 거의 없다면 Codex 모델/프롬프트 문제 우선 점검

---

## ❌ 발견된 문제점

### 1. MCP Timeout 문제 (Critical)

**현상**:
- Gemini, Qwen 모두 MCP에서 "Request timed out" 발생
- MCP timeout: 600s (10분)인데도 실패

**가능한 원인**:
1. MCP 서버 자체의 타임아웃 처리 문제
2. AI CLI 실행이 비정상적으로 지연됨
3. 쿼리 길이가 MCP 버퍼를 초과

**영향**:
- v3.6.0에서 타임아웃을 420s로 늘렸지만, MCP 통신 자체가 불안정
- Codex만 안정적으로 작동 (240s 타임아웃)

### 2. Gemini API 에러

**현상**:
- CLI 직접 실행 시에도 API 에러 발생
- 에러 로그: `/tmp/gemini-client-error-Turn.run-sendMessageStream-2025-10-07T16-31-08-535Z.json`

**가능한 원인**:
1. Gemini API 할당량 초과 (429 에러?)
2. OAuth 토큰 문제
3. API 자체의 일시적 장애

**영향**:
- 420s 타임아웃의 효과를 검증할 수 없음
- Model fallback 기능도 테스트 불가

### 3. Qwen 응답 불완전

**현상**:
- CLI 실행은 시작되었으나 응답 미완료
- 쿼리 이해 부족 ("420초를 평가하라"는 요청을 잘못 이해)

**가능한 원인**:
1. Plan Mode에서 쿼리 해석 오류
2. 백그라운드 프로세스 미완료
3. 타임아웃 내 응답 생성 실패

**영향**:
- 420s 타임아웃의 적절성 검증 불가

---

## 📈 v3.6.0 안정성 평가

### 테스트 통과율

| 테스트 방법 | Codex | Gemini | Qwen | 전체 |
|------------|-------|--------|------|------|
| **MCP 도구** | ✅ 1/1 | ❌ 0/1 | ❌ 0/1 | **33%** |
| **Bash CLI** | ✅ 1/1 | ❌ 0/1 | ⚠️ 0/1 | **33%** |
| **전체** | ✅ 2/2 | ❌ 0/2 | ⚠️ 0/2 | **33%** |

### 점수

**v3.6.0 안정성**: **4.5/10** ❌

**평가 근거**:
- ✅ Codex: 100% 안정 (2/2)
- ❌ Gemini: 0% 안정 (0/2) - MCP timeout + API 에러
- ❌ Qwen: 0% 안정 (0/2) - MCP timeout + 응답 불완전

**이전 버전 대비**:
- v1.6.0 실제 테스트: **9.2/10** (Codex 8.6s, Gemini 13.6s, Qwen 9.6s 모두 성공)
- v3.6.0 교차검증: **4.5/10** (Codex만 성공, Gemini/Qwen 실패)

**결론**: **v3.6.0은 v1.6.0 대비 안정성이 저하됨** ⚠️

---

## 🎯 핵심 발견사항

### 1. 타임아웃 증가만으로는 불충분

**문제**:
- Codex: 240s 타임아웃 → 13초 응답 (여유 충분)
- Gemini: 420s 타임아웃 → MCP timeout (600s도 초과)
- Qwen: 420s 타임아웃 → 응답 미완료

**결론**:
타임아웃 값을 늘리는 것만으로는 안정성을 보장할 수 없음. 근본 원인 분석 필요.

### 2. MCP 통신 안정성 문제

**MCP 600s timeout인데도 Gemini/Qwen 실패**:
- AI CLI 자체의 문제인지
- MCP 서버의 문제인지
- 쿼리 처리 방식의 문제인지

**v1.6.0에서는 성공했던 간단한 쿼리도 v3.6.0에서 실패**:
- v1.6.0: "1+1은?" → 13.6s 성공
- v3.6.0: "v3.6.0 평가: 단순 구조" → MCP timeout

### 3. Codex만 일관되게 안정적

**Codex 성공 요인**:
- 240s 타임아웃 (420s보다 짧음)
- MCP 통신 안정적
- 실무적 조언 제공

**Gemini/Qwen 실패 요인**:
- 420s 타임아웃 (더 긺)
- MCP 통신 불안정
- API 에러 또는 응답 미완료

---

## 🚨 권장사항

### 즉시 조치 (Critical)

1. **v3.6.0 롤백 고려**:
   - 현재 33% 성공률은 production-ready 아님
   - v1.6.0 (9.2/10)으로 롤백 또는 재검증 필요

2. **MCP 통신 디버깅**:
   - Gemini/Qwen MCP timeout 근본 원인 파악
   - MCP 서버 로그 확인
   - AI CLI 직접 실행 vs MCP 실행 비교

3. **Gemini API 상태 확인**:
   - 에러 로그 분석: `/tmp/gemini-client-error-*.json`
   - OAuth 토큰 재발급
   - API 할당량 확인

### 단기 개선 (High Priority)

1. **타임아웃 전략 재검토**:
   - 420s는 과도할 수 있음
   - Codex 240s가 더 안정적
   - Gemini/Qwen도 240s 또는 300s로 하향 조정 고려

2. **복잡도 감지 재도입 고려**:
   - 단순 쿼리: 60s
   - 중간 쿼리: 120s
   - 복잡 쿼리: 240s
   - 일률적 420s보다 효율적일 수 있음

3. **재시도 로직 강화**:
   - 현재 1회 → 2~3회로 증가
   - Exponential backoff 적용

### 장기 개선 (Medium Priority)

1. **로그 기반 타임아웃 튜닝**:
   - `logs/ai-perf/` 분석
   - P95/P99 기반 안전 계수 재계산
   - AI별 최적 타임아웃 도출

2. **MCP 안정성 개선**:
   - MCP 서버 타임아웃 처리 개선
   - AI CLI 래퍼 안정성 강화
   - Progress callback 기능 활용

3. **교차검증 자동화**:
   - 3-AI 병렬 실행 스크립트 안정화
   - 성공률 모니터링 자동화
   - 회귀 테스트 도입

---

## 📊 결론

### v3.6.0 종합 평가

| 항목 | 평가 | 비고 |
|------|------|------|
| **안정성** | ❌ 4.5/10 | Codex만 안정, Gemini/Qwen 실패 |
| **타임아웃 적절성** | ⚠️ 부분적 | Codex 240s 적절, Gemini/Qwen 420s 검증 불가 |
| **MCP 통신** | ❌ 불안정 | Gemini/Qwen timeout 발생 |
| **실제 동작** | ⚠️ 33% | 3-AI 중 1개만 성공 |
| **Production Ready** | ❌ No | v1.6.0 (9.2/10) 대비 저하 |

### 최종 권고: **v3.6.0 롤백 또는 재검증 필요** ⚠️

**이유**:
1. 33% 성공률은 production 배포 불가
2. v1.6.0 (9.2/10)이 더 안정적
3. MCP timeout 문제 해결 필요
4. Gemini API 에러 해결 필요

**다음 단계**:
1. v3.6.0 → v1.6.0 롤백
2. MCP 통신 안정성 개선
3. Gemini API 에러 해결
4. 재검증 후 v3.6.1 또는 v3.7.0 준비

---

**검증 완료 시각**: 2025-10-08 01:35 KST
**검증 담당**: Claude Code + Multi-AI (Codex 단독 성공)
