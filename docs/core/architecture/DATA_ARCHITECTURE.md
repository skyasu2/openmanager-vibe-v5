# ì„œë²„ ë°ì´í„° ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-12-17
**ì‘ì„±ì**: Antigravity + User Feedback
**ëª©ì **: ë‚œê°œë°œ ë°©ì§€ ë° Zero-Internal-Traffic ì•„í‚¤í…ì²˜ í™•ë¦½

---

## ğŸ¯ ì„¤ê³„ ì˜ë„: Zero-Internal-Traffic Strategy

### ì™œ ì´ ì•„í‚¤í…ì²˜ì¸ê°€?
AI/ML ì„œë¹„ìŠ¤ê°€ ë‹¨ìˆœíˆ APIë¥¼ í˜¸ì¶œí•˜ëŠ” ë¹„íš¨ìœ¨ì ì¸ êµ¬ì¡°ë¥¼ íƒˆí”¼í•˜ê³ , ê° ì„œë¹„ìŠ¤ì˜ íŠ¹ì„±ì— ë§ëŠ” **ìµœì ì˜ ë°ì´í„° ì ‘ê·¼ ê²½ë¡œ**ë¥¼ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

- **Vercel API**: ì˜¤ì§ **ì™¸ë¶€ í´ë¼ì´ì–¸íŠ¸(User Interface)**ì˜ ìš”ì²­ë§Œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- **Internal Services**: APIë¥¼ ê±°ì¹˜ì§€ ì•Šê³  **Direct Access (File/DB/Memory)**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

### ğŸš€ Optimized Data Flow

| Service | ê¸°ì¡´ (Bad Flow) âŒ | **ê°œì„ ëœ (Optimized Flow) âœ…** | Data Source |
| :--- | :--- | :--- | :--- |
| **Client UI** | Vercel API í˜¸ì¶œ | **Direct Logic** (Local File) | `src/data/fixed-24h-metrics.ts` |
| **AI (RAG)** | Vercel API í˜¸ì¶œ | **DB Query (Direct)** | **Supabase `server_logs` (RAG)** |
| **ML Service** | Vercel API í˜¸ì¶œ | **Memory Load (Pre-processed)** | `data/fixed-24h-data.json` |

### ğŸ› ï¸ í•µì‹¬ ì´ì 

1.  **Cost Efficiency**: ë¶ˆí•„ìš”í•œ ë‚´ë¶€ API í˜¸ì¶œ ì œê±°ë¡œ **Vercel ë¹„ìš© $0** ìœ ì§€.
2.  **Latency**: ML/AI ì„œë¹„ìŠ¤ì˜ ë°ì´í„° ì ‘ê·¼ ì§€ì—° ì‹œê°„ì´ **Network RTT(ìˆ˜ì‹­ ms) â†’ Memory Access(ë§ˆì´í¬ë¡œì´ˆ)**ë¡œ ë‹¨ì¶•.
3.  **Realism**: AIëŠ” ë‹¨ìˆœ í…ìŠ¤íŠ¸ ìƒì„±ì´ ì•„ë‹Œ, **ì‹¤ì œ DB(Supabase)**ë¥¼ ì¡°íšŒí•˜ì—¬ ë¡œê·¸ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.

### 24ì‹œê°„ íšŒì „ ë°ì´í„° ì‹œìŠ¤í…œ (SSOT)

**Single Source of Truth**: ëª¨ë“  ë°ì´í„°ëŠ” `fixed-24h-metrics.ts`ì—ì„œ ì‹œì‘ë©ë‹ˆë‹¤.

| ì‹œê°„ëŒ€ | ì‹œë‚˜ë¦¬ì˜¤ | Critical ì„œë²„ | ì—°ì‡„ ì˜í–¥ |
|--------|----------|---------------|-----------|
| 02ì‹œ | DB ìŠ¬ë¡œìš° ì¿¼ë¦¬ | db-main-01, db-repl-01 | API ì§€ì—° |
| 07ì‹œ | ë„¤íŠ¸ì›Œí¬ íŒ¨í‚· ì†ì‹¤ | web-prd-01/02, lb-main-01 | ì „ì²´ ì ‘ê·¼ ë¶ˆê°€ |
| 12ì‹œ | OOM Killer ì§ì „ | api-prd-01, cache-redis-01/02 | ìºì‹œ ë¯¸ìŠ¤ ê¸‰ì¦ |
| 17ì‹œ | ë””ìŠ¤í¬ 90% ì´ˆê³¼ | storage-nas-01, backup-server-01 | ì“°ê¸° ì‘ì—… ì‹¤íŒ¨ |
| 22ì‹œ | CPU 95% ê³¼ë¶€í•˜ | web-prd-01/02, api-prd-01/02 | ì‘ë‹µ ì§€ì—° ì‹¬í™” |

---

## ğŸ›ï¸ Hybrid Architecture (Method C)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Direct Load     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
|   Frontend     â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  fixed-24h-metrics.ts  â”‚
â”‚   Dashboard    â”‚                  â”‚  (Single Source)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â–²
        â”‚ (NO API CALL for Metrics)
        â”‚ 
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Direct Load     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ML Service   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  data/fixed-24h-data.json |
â”‚   Rust Engine  â”‚                  â”‚  (Pre-processed)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Direct Query    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI Engine    â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  Supabase DB           â”‚
â”‚   Analyst      â”‚                  â”‚  table: server_logs    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì—­í•  ë¶„ë‹´**:
- **Internal Logic**: ë¹ ë¥¸ UI ë Œë”ë§, ML ì—°ì‚°
- **Supabase**: AI/ML ë¶„ì„, íˆìŠ¤í† ë¦¬ ì¿¼ë¦¬ (RAG)

---

## ğŸ¯ í•µì‹¬ ì›ì¹™: Single Source of Truth

**ì ˆëŒ€ ê·œì¹™**: ëª¨ë“  ì„œë²„ ë°ì´í„°ëŠ” `fixed-24h-metrics.ts` (ë˜ëŠ” íŒŒìƒëœ JSON/DB)ì—ì„œ ìœ ë˜í•©ë‹ˆë‹¤.

### âŒ ê¸ˆì§€ ì‚¬í•­

```typescript
// âŒ ì ˆëŒ€ ê¸ˆì§€: ì‹¤ì‹œê°„ ëœë¤ ìƒì„±
const randomMetric = Math.random() * 100;

// âŒ ì ˆëŒ€ ê¸ˆì§€: ë…ìì ì¸ Mock ë¡œì§
class MyCustomMockSystem { ... }
```

### âœ… ì˜¬ë°”ë¥¸ ë°©ë²•

```typescript
// âœ… ì˜¬ë°”ë¥¸ ë°©ë²•: SSOT í™œìš©
import { getDataAtMinute } from '@/data/fixed-24h-metrics';
```

---

## ğŸ“ ë°ì´í„° íŒŒì¼ êµ¬ì¡°

### âœ… Active FIles (ì ˆëŒ€ ì‚­ì œ ê¸ˆì§€)

| íŒŒì¼ ê²½ë¡œ                                              | ìš©ë„                            | ìˆ˜ì • ê°€ëŠ¥ ì—¬ë¶€       |
| ------------------------------------------------------ | ------------------------------- | -------------------- |
| `src/data/fixed-24h-metrics.ts`                        | **SSOT (24ì‹œê°„ ê³ ì • ë°ì´í„°)**    | âœ… í•µì‹¬ ë¡œì§ ìˆ˜ì • ì‹œ |
| `cloud-run/rust-inference/data/fixed-24h-data.json`    | Rust ì„œë¹„ìŠ¤ìš© ì „ì²˜ë¦¬ ë°ì´í„°      | âŒ ìë™ ìƒì„±ë¨       |
| `src/scripts/generate-rust-data.ts`                    | JSON ë°ì´í„° ìƒì„± ìŠ¤í¬ë¦½íŠ¸        | âœ… ìˆ˜ë™ ìˆ˜ì • ê°€ëŠ¥    |

---

## ğŸ“ ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì„œë²„ ë°ì´í„° ê´€ë ¨ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ

- [ ] **1ë‹¨ê³„**: `fixed-24h-metrics.ts`ì— ë¡œì§ ì¶”ê°€ ê°€ëŠ¥í•œì§€ í™•ì¸
- [ ] **2ë‹¨ê³„**: AIê°€ í•„ìš”í•œ ë°ì´í„°ë¼ë©´ `src/scripts/seed-logs-supabase-standalone.ts` ì‹¤í–‰í•˜ì—¬ DB ë™ê¸°í™”
- [ ] **3ë‹¨ê³„**: MLì´ í•„ìš”í•œ ë°ì´í„°ë¼ë©´ `npm run generate:rust-data` ì‹¤í–‰í•˜ì—¬ JSON ê°±ì‹ 
- [ ] **4ë‹¨ê³„**: ë‚´ë¶€ ì„œë¹„ìŠ¤ê°€ Vercel APIë¥¼ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸

---

## ğŸ“– ì°¸ê³  ë¬¸ì„œ

- **SSOT**: `src/data/fixed-24h-metrics.ts`
- **Rust ë°ì´í„° ìƒì„±**: `src/scripts/generate-rust-data.ts`
- **ë¡œê·¸ DB ì ì¬**: `src/scripts/seed-logs-supabase-standalone.ts`
