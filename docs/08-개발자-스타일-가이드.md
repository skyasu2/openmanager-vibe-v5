# 🎯 OpenManager AI - 개발자 스타일 가이드

## 📖 **개요**

OpenManager AI v5.11.0의 **Enterprise-Grade** 개발 표준과 **Cursor IDE 최적화** 개발 스타일을 제공합니다.

---

## 🏗️ **아키텍처 설계 철학**

### **1. TimerManager 중심 설계** ⏰
- 모든 setInterval/setTimeout은 TimerManager를 통해서만 사용
- 우선순위 기반 타이머 관리 (critical > high > medium > low)
- AI 처리 중 자동 타이머 정지/복원 시스템

```typescript
// ✅ 권장 방식
import { timerManager } from '@/utils/TimerManager';

timerManager.register({
  id: 'unique-timer-id',
  callback: updateFunction,
  interval: 5000,
  priority: 'high'
});

// ❌ 사용 금지
const interval = setInterval(updateFunction, 5000);
```

### **2. 모듈화 우선 설계** 📦
- 단일 책임 원칙 (SRP) 엄격 적용
- 컴포넌트는 최대 200줄 이하 유지
- 비즈니스 로직은 커스텀 훅으로 분리

```typescript
// ✅ 권장 구조
src/modules/ai-sidebar/
├── components/
│   ├── AISidebar.tsx          // 메인 컴포넌트
│   ├── ChatSection.tsx        // 채팅 UI
│   └── DynamicPresets.tsx     // 프리셋 관리
├── hooks/
│   ├── useAIChat.ts           // 채팅 로직
│   └── usePresetRotation.ts   // 프리셋 로직
├── types/
│   └── index.ts               // 타입 정의
└── utils/
    └── chatUtils.ts           // 유틸리티
```

### **3. API 통합 설계** 🌐
- 모든 AI 관련 API는 `/api/ai/unified`로 통합
- RESTful 설계 원칙 준수
- 타입 안전한 API 응답 구조

```typescript
// ✅ 통합 API 엔드포인트 사용
POST /api/ai/unified
{
  "type": "chat" | "analysis" | "prediction",
  "message": "사용자 입력",
  "context": { "serverId": "server-01" }
}
```

---

## 🎨 **컴포넌트 개발 스타일**

### **1. React 성능 최적화 필수 적용**

```typescript
// ✅ React.memo 사용
const DashboardHeader = memo(function DashboardHeader({ 
  systemStatus, 
  onStatusClick 
}: DashboardHeaderProps) {
  return (
    <header className="dashboard-header">
      {/* 헤더 내용 */}
    </header>
  );
});

// ✅ useCallback 사용
const handleServerClick = useCallback((server: ServerData) => {
  systemControl.recordActivity('server_click');
  setSelectedServer(server);
}, [systemControl]);

// ✅ useMemo 사용
const filteredServers = useMemo(() => 
  servers.filter(server => server.status === 'online'), 
  [servers]
);
```

### **2. TypeScript 타입 안전성 100%**

```typescript
// ✅ 엄격한 타입 정의
interface AISidebarConfig {
  apiEndpoint: string;
  enableVoice: boolean;
  enableHistory: boolean;
  refreshInterval?: number;
}

interface ChatMessage {
  id: string;
  type: 'user' | 'assistant' | 'system';
  content: string;
  timestamp: Date;
  metadata?: {
    serverId?: string;
    action?: string;
  };
}

// ✅ 제네릭 활용
type APIResponse<T = any> = {
  success: boolean;
  data: T;
  error?: string;
  timestamp: string;
};
```

### **3. 에러 바운더리 & 폴백 UI**

```typescript
// ✅ Suspense & ErrorBoundary 활용
import { Suspense, lazy } from 'react';

const LazyComponent = lazy(() => import('./HeavyComponent'));

export default function ComponentWrapper() {
  return (
    <ErrorBoundary fallback={<ErrorFallback />}>
      <Suspense fallback={<LoadingSkeleton />}>
        <LazyComponent />
      </Suspense>
    </ErrorBoundary>
  );
}
```

---

## 📁 **파일 및 폴더 네이밍 규칙**

### **1. 파일 네이밍**
```
✅ 권장 방식:
- ComponentName.tsx (PascalCase)
- useCustomHook.ts (camelCase with 'use' prefix)
- apiClient.ts (camelCase)
- constants.ts (camelCase)
- types.ts (camelCase)

❌ 금지 방식:
- component-name.tsx (kebab-case 금지)
- Component_Name.tsx (snake_case 금지)
```

### **2. 폴더 구조**
```
src/
├── app/                    # Next.js App Router
│   ├── dashboard/         # 페이지별 폴더
│   ├── admin/
│   └── api/               # API 라우트
├── components/            # 공통 컴포넌트
│   ├── ui/               # 기본 UI 컴포넌트
│   ├── charts/           # 차트 컴포넌트
│   └── system/           # 시스템 컴포넌트
├── modules/               # 기능별 모듈 (비즈니스 로직)
│   ├── ai-sidebar/
│   └── ai-agent/
├── utils/                 # 유틸리티 함수
│   ├── TimerManager.ts    # 타이머 관리
│   └── apiClient.ts       # API 클라이언트
└── types/                 # 전역 타입 정의
```

---

## 🎯 **Cursor IDE 최적화 개발**

### **1. 주석 스타일 (AI 친화적)**

```typescript
/**
 * 🎯 AI 사이드바 메인 컴포넌트
 * 
 * @description 통합 AI 채팅 인터페이스를 제공합니다.
 * @features
 * - LangGraph 기반 고급 추론 엔진
 * - 동적 질문 생성 시스템  
 * - 실시간 서버 컨텍스트 인식
 * 
 * @example
 * ```tsx
 * <AISidebar 
 *   config={{
 *     apiEndpoint: '/api/ai/unified',
 *     enableVoice: false,
 *     enableHistory: true
 *   }}
 * />
 * ```
 */
export function AISidebar({ config }: AISidebarProps) {
  // 컴포넌트 구현
}
```

### **2. 개발 중 디버깅 팁**

```typescript
// ✅ 개발 중 디버깅 헬퍼
const DEBUG = process.env.NODE_ENV === 'development';

function debugLog(message: string, data?: any) {
  if (DEBUG) {
    console.log(`🐛 [DEBUG] ${message}`, data);
  }
}

// ✅ TimerManager 상태 모니터링
if (DEBUG) {
  // TimerDebugPanel 컴포넌트 사용
  // http://localhost:3000에서 실시간 타이머 상태 확인 가능
}
```

### **3. 코드 스플리팅 가이드라인**

```typescript
// ✅ 페이지 레벨 코드 스플리팅
const DashboardPage = lazy(() => import('./DashboardPage'));
const AdminPage = lazy(() => import('./AdminPage'));

// ✅ 컴포넌트 레벨 코드 스플리팅 (200줄 이상 컴포넌트)
const HeavyComponent = lazy(() => import('./HeavyComponent'));

// ❌ 작은 컴포넌트는 스플리팅 금지 (성능 저하)
const SmallButton = () => <button>클릭</button>; // 이런 건 그냥 사용
```

---

## 🧪 **테스트 개발 스타일**

### **1. 테스트 파일 네이밍**
```
src/components/AISidebar.tsx
src/components/__tests__/AISidebar.test.tsx

src/utils/TimerManager.ts
src/utils/__tests__/TimerManager.test.ts
```

### **2. 테스트 작성 스타일**

```typescript
// ✅ 권장 테스트 구조
describe('AISidebar 컴포넌트', () => {
  beforeEach(() => {
    // 테스트 초기화
  });

  it('✅ 정상적으로 렌더링되어야 함', () => {
    render(<AISidebar config={mockConfig} />);
    expect(screen.getByTestId('ai-sidebar')).toBeInTheDocument();
  });

  it('✅ 사용자 메시지 전송이 정상 작동해야 함', async () => {
    // 테스트 로직
  });
});
```

---

## 📈 **성능 모니터링 & 최적화**

### **1. 핵심 성능 지표**
```typescript
// ✅ 모니터링 대상 지표
const PERFORMANCE_TARGETS = {
  apiResponseTime: '< 15ms',    // API 응답 시간
  memoryUsage: '< 100MB',       // 메모리 사용량
  timerConflicts: '0건',        // 타이머 충돌
  systemStability: '> 98%'      // 시스템 안정성
};
```

### **2. 실시간 성능 확인**
```bash
# 개발 서버 실행 중 성능 로그 확인
npm run dev

# 터미널에서 확인 가능한 정보:
# ⏰ Timer registered: simulation-engine-update (10000ms, high)
# 📊 시뮬레이션 업데이트: 20개 서버, 511개 메트릭
# 🚀 API 응답 시간: 9-12ms
# 🔒 메모리 효율성: +85% 향상
```

---

## 🔧 **일반적인 문제 해결**

### **1. TimerManager 마이그레이션**

```typescript
// 🔄 마이그레이션 체크리스트
// 1. 기존 setInterval 찾기
const oldTimer = setInterval(callback, 5000); // ❌

// 2. TimerManager로 교체
timerManager.register({
  id: 'unique-id',
  callback: callback,
  interval: 5000,
  priority: 'medium'
}); // ✅

// 3. cleanup 확인
useEffect(() => {
  return () => {
    timerManager.unregister('unique-id');
  };
}, []);
```

### **2. API 통합 마이그레이션**

```typescript
// 🔄 분산된 API를 통합 API로 변경
// Before ❌
fetch('/api/ai/prediction');
fetch('/api/ai/mcp');
fetch('/api/ai-agent/integrated');

// After ✅
fetch('/api/ai/unified', {
  method: 'POST',
  body: JSON.stringify({
    type: 'prediction' | 'mcp' | 'agent',
    // ...
  })
});
```

---

## 📚 **추가 참고 문서**

- [01-설치-개발-가이드.md](./01-설치-개발-가이드.md) - 개발 환경 설정
- [07-MCP-개발가이드.md](./07-MCP-개발가이드.md) - MCP AI 시스템 개발  
- [TESTING.md](./TESTING.md) - 테스트 가이드
- [06-문제해결-가이드.md](./06-문제해결-가이드.md) - 문제 해결

---

## 🎯 **개발 워크플로우**

### **1. 새로운 컴포넌트 개발 시**
```bash
# 1. 모듈 폴더 생성
mkdir src/modules/new-feature

# 2. 기본 구조 생성
touch src/modules/new-feature/components/NewComponent.tsx
touch src/modules/new-feature/hooks/useNewFeature.ts  
touch src/modules/new-feature/types/index.ts

# 3. 테스트 파일 생성
touch src/modules/new-feature/__tests__/NewComponent.test.tsx
```

### **2. 개발 중 체크리스트**
- [ ] TimerManager 사용 확인
- [ ] TypeScript 타입 안전성 100%
- [ ] React.memo/useCallback 최적화 적용
- [ ] 에러 바운더리 적용
- [ ] 테스트 코드 작성
- [ ] JSDoc 주석 작성

---

**🎯 이 가이드를 따라 개발하면 Enterprise-Grade 품질의 일관된 코드를 작성할 수 있습니다!** 