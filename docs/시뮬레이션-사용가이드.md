# ğŸ¯ ì „ì—­ ì„¸ì…˜ ì‹œë®¬ë ˆì´ì…˜ ì‹œìŠ¤í…œ ì‚¬ìš© ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

OpenManager Vibe v5ì˜ ì „ì—­ ì„¸ì…˜ ì‹œë®¬ë ˆì´ì…˜ ì‹œìŠ¤í…œì€ **ëˆ„ê°€ ëœë”©í˜ì´ì§€ì—ì„œ ë“¤ì–´ì™€ë„ ë™ì¼í•œ 1ì‹œê°„ì§œë¦¬ ì‹œë®¬ë ˆì´ì…˜ì„ ê³µìœ **í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

### ğŸ¯ í•µì‹¬ íŠ¹ì§•

- âœ… **ì „ì—­ ì„¸ì…˜**: ëª¨ë“  ì‚¬ìš©ìê°€ ê°™ì€ ì‹œë®¬ë ˆì´ì…˜ ì„¸ì…˜ ê³µìœ 
- âœ… **60ë¶„ ì‹œë‚˜ë¦¬ì˜¤**: 5ë¶„ ë‹¨ìœ„ 12ë‹¨ê³„ë¡œ êµ¬ì„±ëœ ì™„ì „í•œ ì¥ì• /ë³µêµ¬ ì‹œë‚˜ë¦¬ì˜¤
- âœ… **Redis ê¸°ë°˜**: `sim:global:session` í‚¤ë¡œ ì„¸ì…˜ ê´€ë¦¬
- âœ… **ìë™ ê°±ì‹ **: 60ë¶„ ê²½ê³¼ ì‹œ ìƒˆë¡œìš´ ì„¸ì…˜ ìë™ ìƒì„±
- âœ… **ì„±ëŠ¥ ìµœì í™”**: 100ëª…ì´ ë™ì‹œ ì ‘ì†í•´ë„ ì„¸ì…˜ 1ê°œë§Œ ìœ ì§€

---

## ğŸ”§ API ì—”ë“œí¬ì¸íŠ¸

### 1. ì‹œë®¬ë ˆì´ì…˜ ì´ˆê¸°í™”
```bash
GET /api/simulate/init
```

**ì‘ë‹µ ì˜ˆì‹œ (ìƒˆ ì„¸ì…˜):**
```json
{
  "success": true,
  "newSession": true,
  "startedAt": "2025-05-25T14:00:00Z",
  "minutesElapsed": 0,
  "sessionId": "global_1740825600000_abc123def",
  "currentStep": 0,
  "totalSteps": 12,
  "nextDataUpdate": "2025-05-25T14:05:00Z"
}
```

**ì‘ë‹µ ì˜ˆì‹œ (ê¸°ì¡´ ì„¸ì…˜):**
```json
{
  "success": true,
  "newSession": false,
  "startedAt": "2025-05-25T14:00:00Z",
  "minutesElapsed": 12,
  "sessionId": "global_1740825600000_abc123def",
  "currentStep": 2,
  "totalSteps": 12,
  "nextDataUpdate": "2025-05-25T14:15:00Z"
}
```

### 2. ì‹œë®¬ë ˆì´ì…˜ ìŠ¤í… ì‹¤í–‰
```bash
POST /api/simulate/step
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "success": true,
  "step": 3,
  "timestamp": "2025-05-25T14:15:00Z",
  "dataKey": "sim:global:data:1740826500",
  "serversAffected": 1,
  "newIssues": 1,
  "description": "K8s ë§ˆìŠ¤í„° ë…¸ë“œ ë¦¬ì†ŒìŠ¤ ê³ ê°ˆ"
}
```

### 3. ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ì¡°íšŒ
```bash
# í˜„ì¬ ë°ì´í„° ì¡°íšŒ
GET /api/simulate/data?step=current

# íŠ¹ì • ìŠ¤í… ë°ì´í„° ì¡°íšŒ
GET /api/simulate/data?step=5

# íŠ¹ì • íƒ€ì„ìŠ¤íƒ¬í”„ ë°ì´í„° ì¡°íšŒ
GET /api/simulate/data?timestamp=1740826500
```

### 4. ì„¸ì…˜ ìƒíƒœ í™•ì¸
```bash
OPTIONS /api/simulate/data
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "success": true,
  "hasActiveSession": true,
  "session": {
    "sessionId": "global_1740825600000_abc123def",
    "startedAt": "2025-05-25T14:00:00Z",
    "minutesElapsed": 25,
    "currentStep": 5,
    "totalSteps": 12,
    "isCompleted": false,
    "remainingMinutes": 35
  },
  "dataStatus": {
    "availableSteps": [0, 1, 2, 3, 4, 5],
    "totalGeneratedSteps": 6,
    "nextStepDue": "2025-05-25T14:30:00Z"
  }
}
```

---

## ğŸ­ ì‹œë®¬ë ˆì´ì…˜ ì‹œë‚˜ë¦¬ì˜¤

### 12ë‹¨ê³„ ì‹œë‚˜ë¦¬ì˜¤ êµ¬ì„±

| ìŠ¤í… | ì‹œê°„ | ì‹œë‚˜ë¦¬ì˜¤ | ì„¤ëª… |
|------|------|----------|------|
| 0 | 0-5ë¶„ | ğŸŸ¢ **Stable Start** | ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘ - ëª¨ë“  ì‹œìŠ¤í…œ ì •ìƒ |
| 1 | 5-10ë¶„ | ğŸŸ¡ **Load Increase** | ì¼ë¶€ ì„œë²„ì—ì„œ ë¶€í•˜ ì¦ê°€ ê°ì§€ (3ëŒ€ ì˜í–¥) |
| 2 | 10-15ë¶„ | ğŸŸ¡ **Database Load** | DB ì—°ê²° í’€ ì‚¬ìš©ë¥  ì¦ê°€ (2ëŒ€ ì˜í–¥) |
| 3 | 15-20ë¶„ | ğŸ”´ **First Failure** | K8s ë§ˆìŠ¤í„° ë…¸ë“œ ë¦¬ì†ŒìŠ¤ ê³ ê°ˆ (1ëŒ€ Critical) |
| 4 | 20-25ë¶„ | ğŸ”´ **Cascade Failure** | ì¥ì•  ì—°ì‡„ ë°˜ì‘ - ë‹¤ì¤‘ ì„œë²„ ì˜í–¥ (4ëŒ€ ì˜í–¥) |
| 5 | 25-30ë¶„ | ğŸŸ¡ **Recovery Start** | ë³µêµ¬ ì ˆì°¨ ì‹œì‘ - ë¶€í•˜ ê°ì†Œ ì¤‘ (2ëŒ€ ì˜í–¥) |
| 6 | 30-35ë¶„ | ğŸŸ¢ **Stabilization** | ì‹œìŠ¤í…œ ì•ˆì •í™” ì§„í–‰ ì¤‘ (1ëŒ€ ì˜í–¥) |
| 7 | 35-40ë¶„ | ğŸŸ¡ **Storage Issue** | ìŠ¤í† ë¦¬ì§€ ìš©ëŸ‰ ë¶€ì¡± ê²½ê³  (2ëŒ€ ì˜í–¥) |
| 8 | 40-45ë¶„ | ğŸŸ¡ **Network Issue** | ë„¤íŠ¸ì›Œí¬ ì§€ì—° ì¦ê°€ ê°ì§€ (5ëŒ€ ì˜í–¥) |
| 9 | 45-50ë¶„ | ğŸŸ¢ **Optimization** | ìë™ ìµœì í™” ì ìš© - ì„±ëŠ¥ ê°œì„  |
| 10 | 50-55ë¶„ | ğŸŸ¢ **Final Stabilization** | ì „ì²´ ì‹œìŠ¤í…œ ì•ˆì •í™” ì™„ë£Œ |
| 11 | 55-60ë¶„ | âœ… **Completion** | ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ - ëª¨ë“  ì‹œìŠ¤í…œ ì •ìƒ |

---

## ğŸ—‚ï¸ Redis ë°ì´í„° êµ¬ì¡°

### ì„¸ì…˜ í‚¤
```redis
Key: sim:global:session
TTL: 3600ì´ˆ (60ë¶„)
Value: {
  "startedAt": "2025-05-25T14:00:00Z",
  "sessionId": "global_1740825600000_abc123def",
  "currentStep": 5,
  "totalSteps": 12
}
```

### ë°ì´í„° í‚¤
```redis
Key: sim:global:data:1740825600  # Unix timestamp
TTL: 3600ì´ˆ (60ë¶„)
Value: {
  "timestamp": "2025-05-25T14:00:00Z",
  "step": 0,
  "sessionId": "global_1740825600000_abc123def",
  "scenario": "Stable Start",
  "description": "ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘ - ëª¨ë“  ì‹œìŠ¤í…œ ì •ìƒ ìš´ì˜",
  "servers": [...], // 30ê°œ ì„œë²„ ìƒíƒœ
  "incidents": [...], // ë°œìƒí•œ ì´ë²¤íŠ¸ë“¤
  "metadata": {
    "totalServers": 30,
    "healthyServers": 30,
    "warningServers": 0,
    "criticalServers": 0,
    "averageCpu": 25,
    "averageMemory": 35,
    "newIssuesCount": 0
  }
}
```

---

## ğŸš€ í”„ë¡ íŠ¸ì—”ë“œ í†µí•© ì˜ˆì‹œ

### 1. ì»´í¬ë„ŒíŠ¸ì—ì„œ ì„¸ì…˜ ì´ˆê¸°í™”
```typescript
// components/SimulationStatus.tsx
import { useEffect, useState } from 'react'

interface SimulationSession {
  sessionId: string
  startedAt: string
  minutesElapsed: number
  currentStep: number
  totalSteps: number
  isActive: boolean
}

export function SimulationStatus() {
  const [session, setSession] = useState<SimulationSession | null>(null)

  useEffect(() => {
    async function initSimulation() {
      try {
        const response = await fetch('/api/simulate/init')
        const data = await response.json()
        
        if (data.success) {
          setSession({
            sessionId: data.sessionId,
            startedAt: data.startedAt,
            minutesElapsed: data.minutesElapsed,
            currentStep: data.currentStep,
            totalSteps: data.totalSteps,
            isActive: data.minutesElapsed < 60
          })
        }
      } catch (error) {
        console.error('Failed to initialize simulation:', error)
      }
    }

    initSimulation()
  }, [])

  if (!session) return <div>ì„¸ì…˜ ë¡œë”© ì¤‘...</div>

  return (
    <div className="bg-blue-50 p-4 rounded-lg">
      <h3 className="font-semibold">ğŸ¯ ì‹œë®¬ë ˆì´ì…˜ ì„¸ì…˜</h3>
      <p>ì„¸ì…˜ ID: {session.sessionId}</p>
      <p>ê²½ê³¼ ì‹œê°„: {session.minutesElapsed}ë¶„</p>
      <p>í˜„ì¬ ìŠ¤í…: {session.currentStep}/{session.totalSteps}</p>
      <p>ìƒíƒœ: {session.isActive ? 'ğŸŸ¢ ì§„í–‰ ì¤‘' : 'ğŸ”´ ì™„ë£Œ'}</p>
    </div>
  )
}
```

### 2. ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸
```typescript
// hooks/useSimulationData.ts
import { useEffect, useState } from 'react'

export function useSimulationData() {
  const [currentData, setCurrentData] = useState(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    async function fetchCurrentData() {
      try {
        const response = await fetch('/api/simulate/data?step=current')
        const data = await response.json()
        
        if (data.success) {
          setCurrentData(data.data)
        }
      } catch (error) {
        console.error('Failed to fetch simulation data:', error)
      } finally {
        setLoading(false)
      }
    }

    // ì´ˆê¸° ë¡œë“œ
    fetchCurrentData()

    // 5ë¶„ë§ˆë‹¤ ì—…ë°ì´íŠ¸
    const interval = setInterval(fetchCurrentData, 5 * 60 * 1000)
    
    return () => clearInterval(interval)
  }, [])

  return { currentData, loading }
}
```

---

## âš¡ ì„±ëŠ¥ ìµœì í™”

### ë™ì‹œ ì ‘ì†ì ì²˜ë¦¬
- **ë¬¸ì œ**: 10ëª…ì´ ë™ì‹œì— `/api/simulate/init` í˜¸ì¶œ
- **í•´ê²°**: Redis ì „ì—­ ì„¸ì…˜ìœ¼ë¡œ ëª¨ë“  ì‚¬ìš©ìê°€ ë™ì¼í•œ ë°ì´í„° ì°¸ì¡°
- **ê²°ê³¼**: ì„œë²„ ë¶€í•˜ ìµœì†Œí™”, ì¼ê´€ëœ ì‚¬ìš©ì ê²½í—˜

### ìºì‹± ì „ëµ
- **ì„¸ì…˜ ë°ì´í„°**: 60ë¶„ TTL, ìë™ ë§Œë£Œ
- **ìŠ¤í… ë°ì´í„°**: 1ì‹œê°„ TTL, í•„ìš”ì‹œì—ë§Œ ìƒì„±
- **ë©”ëª¨ë¦¬ íš¨ìœ¨**: ë¶ˆí•„ìš”í•œ ë°ì´í„° ìë™ ì •ë¦¬

### ì—ëŸ¬ ì²˜ë¦¬
- **Redis ì—°ê²° ì‹¤íŒ¨**: ê°œë°œ ëª¨ë“œì—ì„œ ë©”ëª¨ë¦¬ ìºì‹œ fallback
- **ì„¸ì…˜ ë§Œë£Œ**: ìë™ìœ¼ë¡œ ìƒˆ ì„¸ì…˜ ìƒì„±
- **ë°ì´í„° ëˆ„ë½**: ëª…í™•í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ì™€ í•´ê²° ë°©ë²• ì œì‹œ

---

## ğŸ”„ ìš´ì˜ ê°€ì´ë“œ

### ì„¸ì…˜ ìƒíƒœ ëª¨ë‹ˆí„°ë§
```bash
# í˜„ì¬ í™œì„± ì„¸ì…˜ í™•ì¸
curl http://localhost:3000/api/simulate/data/status

# ì„¸ì…˜ ê°•ì œ ì´ˆê¸°í™” (ê°œë°œìš©)
curl -X DELETE http://localhost:3000/api/simulate/init
```

### ë¡œê·¸ í™•ì¸
```bash
# ì„¸ì…˜ ìƒì„± ë¡œê·¸
ğŸŒ New global simulation session created: global_1740825600000_abc123def

# ìŠ¤í… ì‹¤í–‰ ë¡œê·¸
ğŸ“Š Simulation step 3 created: Step 3
   Affected servers: 1, New issues: 1

# ë°ì´í„° ìƒì„± ë¡œê·¸
ğŸ“Š Initial simulation data created: sim:global:data:1740825600
   Healthy: 30, Warning: 0, Critical: 0
```

---

## ğŸ‰ ì™„ë£Œ!

ì´ì œ ì „ì—­ ì„¸ì…˜ ê¸°ë°˜ ì‹œë®¬ë ˆì´ì…˜ ì‹œìŠ¤í…œì´ ì™„ì „íˆ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤:

âœ… **ì„¸ì…˜ ê´€ë¦¬**: `sim:global:session` í‚¤ë¡œ 60ë¶„ ì„¸ì…˜  
âœ… **ë°ì´í„° ìƒì„±**: 5ë¶„ ë‹¨ìœ„ ìŠ¤í…ë³„ ì‹œë‚˜ë¦¬ì˜¤  
âœ… **ì„±ëŠ¥ ìµœì í™”**: ë‹¤ì¤‘ ì‚¬ìš©ì ë™ì¼ ì„¸ì…˜ ê³µìœ   
âœ… **API ì™„ì„±**: init, step, data, status ì—”ë“œí¬ì¸íŠ¸  
âœ… **ì‹œë‚˜ë¦¬ì˜¤ ì™„ì„±**: 12ë‹¨ê³„ ì™„ì „í•œ ì¥ì• /ë³µêµ¬ ìŠ¤í† ë¦¬  

**ëˆ„ê°€ ëœë”©í˜ì´ì§€ì—ì„œ ë“¤ì–´ì™€ë„ ëª¨ë‘ ê°™ì€ ë“œë¼ë§ˆí‹±í•œ 1ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜ì„ ê²½í—˜í•˜ê²Œ ë©ë‹ˆë‹¤!** ğŸš€ 