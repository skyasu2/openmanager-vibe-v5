# 배포 가이드

## 🚀 배포 환경

### 기본 정보
- **배포 플랫폼**: Vercel
- **프레임워크**: Next.js 15
- **지역**: 서울(icn1) / 도쿄(nrt1)
- **Node.js 버전**: 18.x

## 🔄 배포 워크플로우

### 자동 배포
1. **GitHub 연동**
   - GitHub 레포지토리 메인 브랜치에 변경사항 푸시
   - Vercel 자동 빌드 및 배포 트리거

2. **브랜치별 배포**
   - `main`: 프로덕션 환경 (https://openmanager-vibe-v5.vercel.app)
   - `develop`: 개발 환경 (https://dev-openmanager-vibe-v5.vercel.app)
   - 기능 브랜치: 미리보기 환경 (https://[branch]-openmanager-vibe-v5.vercel.app)

### 수동 배포
```bash
# Vercel CLI 설치
npm i -g vercel

# 로그인
vercel login

# 수동 배포
vercel

# 프로덕션 배포
vercel --prod
```

## ⚙️ 환경 변수 설정

### Vercel 프로젝트 설정
1. Vercel 대시보드 접속
2. 프로젝트 선택 > Settings > Environment Variables
3. 다음 환경 변수 추가:

| 변수명 | 설명 | 노출 여부 |
|--------|------|-----------|
| `NEXT_PUBLIC_SUPABASE_URL` | Supabase 프로젝트 URL | 공개 |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Supabase 익명 키 | 공개 |
| `SUPABASE_SERVICE_ROLE_KEY` | Supabase 서비스 키 | 비공개 |
| `UPSTASH_REDIS_REST_URL` | Upstash Redis URL | 비공개 |
| `UPSTASH_REDIS_REST_TOKEN` | Upstash Redis 토큰 | 비공개 |

## 📝 Vercel 설정 파일

### vercel.json
```json
{
  "framework": "nextjs",
  "buildCommand": "npm run build",
  "devCommand": "npm run dev",
  "installCommand": "npm install",
  "regions": ["icn1"],
  "functions": {
    "src/app/api/**/*.ts": {
      "maxDuration": 10
    }
  }
}
```

## 🔍 배포 후 확인사항

### 상태 확인
- `/api/health` 엔드포인트로 시스템 상태 확인
- 모든 API 엔드포인트 정상 작동 여부 확인

### 성능 모니터링
- Vercel Analytics 확인
- API 응답 시간 및 서버리스 함수 실행 시간 확인

## 🔄 롤백 및 복구

### 배포 롤백
1. Vercel 대시보드 접속
2. 프로젝트 선택 > Deployments
3. 이전 배포 버전 선택
4. "Promote to Production" 버튼 클릭

### 문제 해결
- 배포 로그 확인: Vercel 대시보드 > Deployments > 배포 선택 > Build Logs
- 서버리스 함수 로그: Vercel 대시보드 > Functions
- 환경 변수 누락 여부 확인

## 🔐 도메인 및 SSL 설정

### 사용자 정의 도메인
1. Vercel 대시보드 > 프로젝트 선택 > Settings > Domains
2. 도메인 추가 및 DNS 설정

### SSL 인증서
- Vercel에서 자동으로 Let's Encrypt SSL 인증서 발급
- 갱신도 자동으로 처리됨

## 🚨 주의사항

- **환경 변수**: 민감한 API 키는 반드시 비공개(SERVER ONLY) 환경변수로 설정
- **리소스 제한**: Vercel 무료 플랜 한도 확인 (함수 실행 시간, 대역폭 등)
- **API 로직**: 서버리스 함수 최대 실행 시간 10초 이내로 최적화 