# 고급 트러블슈팅 시나리오

## 복합 장애 패턴

### CPU + 메모리 복합 장애
**증상**: CPU 85%+, 메모리 90%+ 동시 발생
**원인**: 
- 메모리 누수로 인한 가비지 컬렉션 과부하
- 대용량 데이터 처리 작업
- 무한 루프 또는 재귀 호출

**조치 방법**:
1. 메모리 덤프 분석
2. 프로세스별 리소스 사용량 확인
3. 애플리케이션 로그 분석
4. 필요시 서비스 재시작

### 디스크 + 네트워크 복합 장애
**증상**: 디스크 90%+, 네트워크 I/O 지연
**원인**:
- 대용량 파일 전송
- 로그 파일 급격한 증가
- 백업 프로세스 오류

**조치 방법**:
1. 디스크 사용량 분석 (`df -h`)
2. 네트워크 트래픽 모니터링
3. 불필요한 파일 정리
4. 백업 스케줄 조정

## 연쇄 장애 시나리오

### 시나리오 1: 디스크 포화 → DB 지연 → 웹 서비스 응답 지연
1. **1단계**: 디스크 용량 90% 초과
2. **2단계**: DB 트랜잭션 로그 쓰기 지연
3. **3단계**: DB 쿼리 응답 시간 증가
4. **4단계**: 웹 애플리케이션 응답 타임아웃
5. **5단계**: 사용자 경험 저하 및 에러 증가

**예방 조치**:
- 디스크 사용률 80% 경고 알람 설정
- DB 로그 순환 정책 수립
- 애플리케이션 타임아웃 설정 최적화

### 시나리오 2: 메모리 누수 → CPU 급증 → 시스템 불안정
1. **1단계**: 애플리케이션 메모리 누수
2. **2단계**: 가비지 컬렉션 빈도 증가
3. **3단계**: CPU 사용률 급상승
4. **4단계**: 시스템 응답 속도 저하
5. **5단계**: 서비스 중단 위험

**대응 방안**:
- 메모리 프로파일링 도구 활용
- 힙 덤프 정기 분석
- 자동 재시작 정책 수립

## 모니터링 지표

### 핵심 성능 지표 (KPI)
- **CPU 사용률**: 평균 < 70%, 최대 < 90%
- **메모리 사용률**: 평균 < 75%, 최대 < 90%
- **디스크 사용률**: < 80%
- **네트워크 지연**: < 100ms
- **서비스 응답시간**: < 2초

### 알림 임계값
- **위험 수준**: 3개 이상 메트릭이 임계값 초과
- **경고 수준**: 2개 메트릭이 임계값 근접
- **주의 수준**: 1개 메트릭이 임계값 근접

## 자동화 대응

### 자동 스케일링 조건
- CPU 평균 80% 이상 5분 지속 시 스케일 아웃
- 메모리 사용률 85% 이상 시 인스턴스 추가
- 응답 시간 3초 이상 시 로드밸런서 조정

### 자동 복구 액션
- 프로세스 재시작: 메모리 사용률 95% 초과 시
- 캐시 클리어: 디스크 사용률 90% 초과 시
- 연결 풀 리셋: 네트워크 연결 오류 다발 시 